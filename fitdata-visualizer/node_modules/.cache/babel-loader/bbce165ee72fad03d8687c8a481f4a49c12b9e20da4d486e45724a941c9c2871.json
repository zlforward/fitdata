{"ast":null,"code":"var _jsxFileName = \"D:\\\\source\\\\fitdata\\\\fitdata-visualizer\\\\src\\\\components\\\\TargetDataPrediction.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useCallback, useMemo } from 'react';\nimport * as XLSX from 'xlsx';\nimport { performAllFittings } from '../utils/curveFitting';\nimport { parseExcelData } from '../utils/dataParser';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TargetDataPrediction = ({\n  grayScaleData,\n  brightnessBlocks\n}) => {\n  _s();\n  var _rawData$matrix$, _rawData$matrix$2, _rawData$matrix$3, _rawData$matrix$4, _rawData$matrix$5;\n  const [rawData, setRawData] = useState(null);\n  const [predictionResults, setPredictionResults] = useState([]);\n  const [bestFittingResult, setBestFittingResult] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // 本地状态用于存储从文件解析的数据\n  const [localGrayScaleData, setLocalGrayScaleData] = useState(null);\n  const [localBrightnessBlocks, setLocalBrightnessBlocks] = useState(null);\n  const [doubleClickedCell, setDoubleClickedCell] = useState(null);\n  const [generationProgress, setGenerationProgress] = useState(0);\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [cachedPredictionResults, setCachedPredictionResults] = useState(null);\n\n  // 获取拟合类型标签\n  const getTypeLabel = type => {\n    const labels = {\n      'logarithmic': '对数拟合',\n      'exponential': '指数拟合',\n      'polynomial': '三次多项式拟合',\n      'power': '幂函数拟合',\n      'bivariate': '二次多项式拟合'\n    };\n    return labels[type] || type;\n  };\n\n  // 将数字转换为Excel列名\n  const numToCol = num => {\n    let result = '';\n    while (num > 0) {\n      num--;\n      result = String.fromCharCode(65 + num % 26) + result;\n      num = Math.floor(num / 26);\n    }\n    return result;\n  };\n\n  // 读取Excel Sheet3数据\n  const handleFileUpload = useCallback(async event => {\n    var _event$target$files;\n    const file = (_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0];\n    if (!file) return;\n    setIsLoading(true);\n    setError(null);\n    try {\n      // 清除缓存的预测结果\n      setCachedPredictionResults(null);\n\n      // 使用parseExcelData解析完整数据\n      const parsedData = await parseExcelData(file);\n\n      // 更新本地的grayScaleData和brightnessBlocks\n      setLocalGrayScaleData(parsedData.grayScale);\n      setLocalBrightnessBlocks(parsedData.brightnessBlocks);\n\n      // 设置原始数据（从Sheet3读取）\n      const data = await file.arrayBuffer();\n      const workbook = XLSX.read(new Uint8Array(data), {\n        type: 'array'\n      });\n\n      // 检查是否有Sheet3\n      if (!workbook.SheetNames.includes('Sheet3')) {\n        throw new Error('未找到Sheet3工作表');\n      }\n      const worksheet = workbook.Sheets['Sheet3'];\n      const values = [];\n      const positions = [];\n\n      // 读取A2-AF21范围的原始数据（20行×32列）\n      const startRow = 2;\n      const endRow = 21;\n      const startCol = 'A';\n      const endCol = 'AF';\n\n      // 将列字母转换为数字\n      const colToNum = col => {\n        let result = 0;\n        for (let i = 0; i < col.length; i++) {\n          result = result * 26 + (col.charCodeAt(i) - 'A'.charCodeAt(0) + 1);\n        }\n        return result;\n      };\n      const numToCol = num => {\n        let result = '';\n        while (num > 0) {\n          num--;\n          result = String.fromCharCode('A'.charCodeAt(0) + num % 26) + result;\n          num = Math.floor(num / 26);\n        }\n        return result;\n      };\n      const startColNum = colToNum(startCol);\n      const endColNum = colToNum(endCol);\n\n      // 创建矩阵结构\n      const matrix = [];\n\n      // 按行读取数据\n      for (let row = startRow; row <= endRow; row++) {\n        const rowData = [];\n        for (let colNum = startColNum; colNum <= endColNum; colNum++) {\n          const col = numToCol(colNum);\n          const cellAddress = `${col}${row}`;\n          const cell = worksheet[cellAddress];\n          if (cell && cell.v !== undefined && cell.v !== null && cell.v !== '') {\n            const value = typeof cell.v === 'number' ? cell.v : parseFloat(cell.v.toString());\n            if (!isNaN(value)) {\n              values.push(value);\n              positions.push(cellAddress);\n              rowData.push(value);\n            } else {\n              rowData.push(0);\n            }\n          } else {\n            rowData.push(0);\n          }\n        }\n        matrix.push(rowData);\n      }\n      if (values.length === 0) {\n        throw new Error('Sheet3中未找到有效的原始数据');\n      }\n      setRawData({\n        values,\n        positions,\n        matrix\n      });\n\n      // 自动生成预测结果（延迟确保状态更新完成）\n      setTimeout(async () => {\n        await generatePredictions();\n      }, 100);\n    } catch (error) {\n      setError(error instanceof Error ? error.message : '文件读取失败');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // 获取颜色值\n  const getColor = value => {\n    if (!rawData || !rawData.matrix || rawData.matrix.length === 0) {\n      return 'rgb(255, 255, 255)';\n    }\n    const minValue = Math.min(...rawData.matrix.flat());\n    const maxValue = Math.max(...rawData.matrix.flat());\n    if (maxValue === minValue) return 'rgb(255, 255, 255)';\n    const normalized = (value - minValue) / (maxValue - minValue);\n    const intensity = Math.floor(normalized * 255);\n\n    // 使用蓝色到红色的渐变\n    const red = intensity;\n    const blue = 255 - intensity;\n    const green = Math.floor(128 * (1 - Math.abs(normalized - 0.5) * 2));\n    return `rgb(${red}, ${green}, ${blue})`;\n  };\n\n  // 处理双击事件\n  const handleDoubleClick = useCallback((rowIndex, colIndex) => {\n    // 如果没有缓存的预测结果，提示用户先生成预测数据\n    if (!cachedPredictionResults) {\n      setError('请先生成预测数据后再查看详细结果');\n      return;\n    }\n    setDoubleClickedCell({\n      row: rowIndex,\n      col: colIndex\n    });\n  }, [cachedPredictionResults]);\n\n  // 关闭双击卡片\n  const handleCloseDoubleClickCard = useCallback(() => {\n    setDoubleClickedCell(null);\n  }, []);\n\n  // 计算双击卡片的预测结果\n  const doubleClickPredictionContent = useMemo(() => {\n    // 使用本地数据（如果有）或传入的props数据\n    const currentGrayScaleData = localGrayScaleData || grayScaleData;\n    const currentBrightnessBlocks = localBrightnessBlocks || brightnessBlocks;\n    if (!rawData || !currentGrayScaleData.values.length || !currentBrightnessBlocks.length || !doubleClickedCell) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"\\u9884\\u6D4B\\u6570\\u636E\\u5C1A\\u672A\\u751F\\u6210\\uFF0C\\u8BF7\\u7B49\\u5F85\\u6570\\u636E\\u5904\\u7406\\u5B8C\\u6210\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 14\n      }, this);\n    }\n\n    // 使用缓存的预测结果，如果没有缓存则返回提示\n    if (!cachedPredictionResults) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"\\u8BF7\\u5148\\u751F\\u6210\\u9884\\u6D4B\\u6570\\u636E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 14\n      }, this);\n    }\n\n    // 直接从缓存中读取该位置的预测结果\n    const cellIndex = doubleClickedCell.row * 32 + doubleClickedCell.col;\n    const cachedResult = cachedPredictionResults[cellIndex];\n    if (!cachedResult) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"\\u8BE5\\u4F4D\\u7F6E\\u6682\\u65E0\\u6709\\u6548\\u62DF\\u5408\\u7ED3\\u679C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 14\n      }, this);\n    }\n    const {\n      rawValue,\n      methodPredictions\n    } = cachedResult;\n    const predictions = Object.entries(methodPredictions);\n    if (predictions.length === 0) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"\\u8BE5\\u4F4D\\u7F6E\\u6682\\u65E0\\u6709\\u6548\\u62DF\\u5408\\u7ED3\\u679C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 14\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-50 p-4 rounded-lg\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"\\u4EAE\\u5EA6\\u503C:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ml-2 font-medium\",\n            children: rawValue.toFixed(2)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n          className: \"font-medium text-gray-700 mb-3\",\n          children: \"\\u6240\\u6709\\u62DF\\u5408\\u65B9\\u6CD5\\u9884\\u6D4B\\u7ED3\\u679C:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overflow-x-auto\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"w-full border-collapse border border-gray-200\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"bg-gray-100\",\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"border border-gray-200 px-3 py-2 text-left font-medium\",\n                  children: \"\\u62DF\\u5408\\u7C7B\\u578B\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 279,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"border border-gray-200 px-3 py-2 text-left font-medium\",\n                  children: \"\\u9884\\u6D4B\\u7ED3\\u679C\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"border border-gray-200 px-3 py-2 text-left font-medium\",\n                  children: \"\\u7F6E\\u4FE1\\u5EA6(R\\xB2)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"border border-gray-200 px-3 py-2 text-left font-medium\",\n                  children: \"\\u62DF\\u5408\\u516C\\u5F0F\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 278,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: predictions.map(([method, prediction]) => {\n                const pred = prediction;\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"hover:bg-gray-50\",\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"border border-gray-200 px-3 py-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-medium text-gray-700\",\n                      children: getTypeLabel(method)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 296,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 295,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"border border-gray-200 px-3 py-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-lg font-bold text-blue-600\",\n                      children: pred.predictedGrayScale.toFixed(6)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 301,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 300,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"border border-gray-200 px-3 py-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-medium\",\n                      children: [(pred.confidence * 100).toFixed(2), \"%\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 306,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 305,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"border border-gray-200 px-3 py-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-sm font-mono text-gray-600 max-w-xs break-all\",\n                      children: pred.formula\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 311,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 310,\n                    columnNumber: 23\n                  }, this)]\n                }, method, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 294,\n                  columnNumber: 21\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }, this);\n  }, [doubleClickedCell, cachedPredictionResults, localGrayScaleData, localBrightnessBlocks, grayScaleData, brightnessBlocks, rawData, getTypeLabel]);\n\n  // 生成预测结果\n  const generatePredictions = useCallback(async () => {\n    if (!rawData) {\n      setError('请先上传原始数据');\n      return;\n    }\n\n    // 使用本地数据（如果有）或传入的props数据\n    const currentGrayScaleData = localGrayScaleData || grayScaleData;\n    const currentBrightnessBlocks = localBrightnessBlocks || brightnessBlocks;\n    if (!currentGrayScaleData.values.length || !currentBrightnessBlocks.length) {\n      setError('无法获取有效的拟合数据');\n      return;\n    }\n    setIsGenerating(true);\n    setGenerationProgress(0);\n    setError(null);\n    try {\n      // 步骤1: 数据验证 (10%)\n      setGenerationProgress(10);\n      await new Promise(resolve => setTimeout(resolve, 100));\n\n      // 提取中心像素值和灰阶值\n      const centerPixelValues = currentBrightnessBlocks.map(block => block.centerPixelValue);\n      const grayScaleValues = currentGrayScaleData.values;\n      if (centerPixelValues.length !== grayScaleValues.length) {\n        setError('拟合数据长度不匹配');\n        return;\n      }\n\n      // 步骤2: 执行拟合算法 (30%)\n      setGenerationProgress(30);\n      await new Promise(resolve => setTimeout(resolve, 200));\n      const allFittingResults = performAllFittings({\n        x: centerPixelValues,\n        y: grayScaleValues\n      });\n\n      // 拟合结果已获取，继续处理预测\n\n      // 步骤3: 找到最佳拟合结果 (50%)\n      setGenerationProgress(50);\n      await new Promise(resolve => setTimeout(resolve, 100));\n      const bestFitting = allFittingResults.reduce((best, current) => {\n        if (isNaN(current.rSquared) || current.rSquared < 0) return best;\n        if (!best || current.rSquared > best.rSquared) return current;\n        return best;\n      }, null);\n      if (!bestFitting) {\n        setError('无法获取有效的拟合结果');\n        return;\n      }\n      setBestFittingResult(bestFitting);\n\n      // 步骤4: 计算预测结果 (80%)\n      setGenerationProgress(80);\n      await new Promise(resolve => setTimeout(resolve, 300));\n      const totalValues = rawData.values.length;\n      const predictions = [];\n      const predictionCache = [];\n      for (let index = 0; index < totalValues; index++) {\n        const rawValue = rawData.values[index];\n        // 计算对应的亮度值\n        let brightnessValue = rawValue; // 使用原始数据值作为亮度值\n\n        // 为每种拟合方法计算预测值\n        const methodPredictions = {};\n        allFittingResults.forEach(fitting => {\n          if (isNaN(fitting.rSquared) || fitting.rSquared < 0) return;\n          let predictedGrayScale = 0;\n\n          // 根据拟合类型计算预测值\n          switch (fitting.type) {\n            case 'logarithmic':\n              if (rawValue > 0) {\n                const [a, b] = fitting.coefficients;\n                predictedGrayScale = a * Math.log(rawValue) + b;\n              }\n              break;\n            case 'exponential':\n              const [a_exp, b_exp] = fitting.coefficients;\n              predictedGrayScale = a_exp * Math.exp(b_exp * rawValue);\n              break;\n            case 'polynomial':\n              const [a_poly, b_poly, c_poly, d_poly] = fitting.coefficients;\n              predictedGrayScale = a_poly * Math.pow(rawValue, 3) + b_poly * Math.pow(rawValue, 2) + c_poly * rawValue + d_poly;\n              break;\n            case 'power':\n              if (rawValue > 0) {\n                const [a_pow, b_pow] = fitting.coefficients;\n                predictedGrayScale = a_pow * Math.pow(rawValue, b_pow);\n              }\n              break;\n            case 'bivariate':\n              const [a_biv, b_biv, c_biv] = fitting.coefficients;\n              predictedGrayScale = a_biv * Math.pow(rawValue, 2) + b_biv * rawValue + c_biv;\n              break;\n          }\n          methodPredictions[fitting.type] = {\n            predictedGrayScale,\n            formula: fitting.formula,\n            confidence: fitting.rSquared,\n            fittingType: fitting.type\n          };\n        });\n        predictions.push({\n          position: rawData.positions[index],\n          brightnessValue,\n          predictions: methodPredictions\n        });\n\n        // 缓存该位置的预测结果供双击功能使用\n        predictionCache.push({\n          rawValue,\n          methodPredictions\n        });\n\n        // 更新进度 (80% - 95%)\n        const progress = 80 + Math.floor(index / totalValues * 15);\n        setGenerationProgress(progress);\n\n        // 每处理100个数据点暂停一下，让UI更新\n        if (index % 100 === 0) {\n          await new Promise(resolve => setTimeout(resolve, 10));\n        }\n      }\n\n      // 缓存预测结果\n      setCachedPredictionResults(predictionCache);\n\n      // 步骤5: 完成 (100%)\n      setGenerationProgress(100);\n      await new Promise(resolve => setTimeout(resolve, 200));\n      setPredictionResults(predictions);\n      setError(null);\n    } catch (err) {\n      console.error('预测生成错误:', err);\n      setError(err instanceof Error ? err.message : '预测生成失败');\n    } finally {\n      setIsGenerating(false);\n      setGenerationProgress(0);\n    }\n  }, [rawData, grayScaleData, brightnessBlocks, localGrayScaleData, localBrightnessBlocks, getTypeLabel]);\n\n  // 导出预测结果到Excel\n  const exportToExcel = useCallback(() => {\n    if (predictionResults.length === 0 || !rawData) {\n      setError('没有预测结果可导出');\n      return;\n    }\n    const workbook = XLSX.utils.book_new();\n\n    // 创建矩阵格式的预测结果工作表\n    const rows = 20; // A2-AF21 共20行\n    const cols = 32; // A-AF 共32列\n\n    // 将列数字转换为字母的辅助函数\n    const numToCol = num => {\n      let result = '';\n      while (num > 0) {\n        num--;\n        result = String.fromCharCode('A'.charCodeAt(0) + num % 26) + result;\n        num = Math.floor(num / 26);\n      }\n      return result;\n    };\n\n    // 创建列标题 (A-AF)\n    const colHeaders = [];\n    for (let i = 0; i < cols; i++) {\n      colHeaders.push(numToCol(i + 1));\n    }\n\n    // 创建原始数据矩阵工作表\n    const originalMatrixData = [];\n    originalMatrixData.push(['', ...colHeaders]);\n    for (let row = 0; row < rows; row++) {\n      const rowData = [row + 2]; // 行号从2开始\n      for (let col = 0; col < cols; col++) {\n        if (row < rawData.matrix.length && col < rawData.matrix[row].length) {\n          rowData.push(rawData.matrix[row][col]);\n        } else {\n          rowData.push('');\n        }\n      }\n      originalMatrixData.push(rowData);\n    }\n    const originalWorksheet = XLSX.utils.aoa_to_sheet(originalMatrixData);\n    XLSX.utils.book_append_sheet(workbook, originalWorksheet, '原始数据');\n\n    // 获取所有拟合方法\n    const allMethods = new Set();\n    predictionResults.forEach(result => {\n      Object.keys(result.predictions).forEach(method => allMethods.add(method));\n    });\n\n    // 为每种拟合方法创建单独的预测结果矩阵\n    Array.from(allMethods).forEach(method => {\n      const methodMatrixData = [];\n      methodMatrixData.push(['', ...colHeaders]);\n      for (let row = 0; row < rows; row++) {\n        const rowData = [row + 2]; // 行号从2开始\n        for (let col = 0; col < cols; col++) {\n          const dataIndex = row * cols + col;\n          if (dataIndex < predictionResults.length && predictionResults[dataIndex].predictions[method]) {\n            rowData.push(parseFloat(predictionResults[dataIndex].predictions[method].predictedGrayScale.toFixed(6)));\n          } else {\n            rowData.push('');\n          }\n        }\n        methodMatrixData.push(rowData);\n      }\n      const methodWorksheet = XLSX.utils.aoa_to_sheet(methodMatrixData);\n      XLSX.utils.book_append_sheet(workbook, methodWorksheet, getTypeLabel(method));\n    });\n\n    // 创建详细预测结果工作表\n    const detailData = [];\n    detailData.push(['位置', '亮度值', '拟合方法', '预测灰阶值', '置信度(R²)', '拟合公式']);\n    predictionResults.forEach(result => {\n      Object.entries(result.predictions).forEach(([method, prediction]) => {\n        detailData.push([result.position, result.brightnessValue.toFixed(2), getTypeLabel(method), prediction.predictedGrayScale.toFixed(6), prediction.confidence.toFixed(6), prediction.formula]);\n      });\n    });\n    const detailWorksheet = XLSX.utils.aoa_to_sheet(detailData);\n    XLSX.utils.book_append_sheet(workbook, detailWorksheet, '详细结果');\n\n    // 添加拟合信息工作表\n    if (bestFittingResult) {\n      const fittingInfo = [['拟合信息', ''], ['最佳拟合类型', getTypeLabel(bestFittingResult.type)], ['拟合公式', bestFittingResult.formula], ['R²值', bestFittingResult.rSquared.toFixed(6)], ['RMSE', bestFittingResult.rmse.toFixed(6)], ['MAE', bestFittingResult.mae.toFixed(6)], ['最大误差', bestFittingResult.maxError.toFixed(6)]];\n      const fittingWs = XLSX.utils.aoa_to_sheet(fittingInfo);\n      XLSX.utils.book_append_sheet(workbook, fittingWs, '拟合信息');\n    }\n\n    // 下载文件\n    const fileName = `原始数据预测结果_${new Date().toISOString().slice(0, 10)}.xlsx`;\n    XLSX.writeFile(workbook, fileName);\n  }, [predictionResults, bestFittingResult, rawData]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white rounded-lg shadow-lg p-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"text-lg font-semibold mb-6\",\n      children: \"\\u539F\\u59CB\\u6570\\u636E\\u9884\\u6D4B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 608,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium mb-3\",\n        children: \"\\u4E0A\\u4F20\\u539F\\u59CB\\u6570\\u636E\\u6587\\u4EF6 (Sheet3)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 612,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \".xlsx,.xls\",\n          onChange: handleFileUpload,\n          className: \"hidden\",\n          id: \"raw-file-upload\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 614,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"raw-file-upload\",\n          className: \"cursor-pointer inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors\",\n          children: \"\\u9009\\u62E9Excel\\u6587\\u4EF6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 621,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-2 text-sm text-gray-500\",\n          children: \"\\u8BF7\\u9009\\u62E9\\u5305\\u542BSheet3\\u5DE5\\u4F5C\\u8868\\u7684Excel\\u6587\\u4EF6\\uFF0C\\u539F\\u59CB\\u6570\\u636E\\u5E94\\u4F4D\\u4E8EA2-AF21\\u8303\\u56F4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 627,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 613,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 611,\n      columnNumber: 7\n    }, this), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-blue-700\",\n        children: \"\\u6B63\\u5728\\u8BFB\\u53D6\\u6587\\u4EF6...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 636,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 635,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-red-700\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 643,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 642,\n      columnNumber: 9\n    }, this), rawData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6 p-4 bg-gray-50 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium mb-2\",\n        children: \"\\u539F\\u59CB\\u6570\\u636E\\u6982\\u89C8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 650,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-4 text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"\\u77E9\\u9635\\u7EF4\\u5EA6:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 653,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ml-2 font-medium\",\n            children: [rawData.matrix.length, \" \\xD7 \", ((_rawData$matrix$ = rawData.matrix[0]) === null || _rawData$matrix$ === void 0 ? void 0 : _rawData$matrix$.length) || 0]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 654,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 652,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"\\u6570\\u503C\\u8303\\u56F4:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 657,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ml-2 font-medium\",\n            children: [Math.min(...rawData.matrix.flat()).toFixed(2), \" - \", Math.max(...rawData.matrix.flat()).toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 658,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 656,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 651,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 649,\n      columnNumber: 9\n    }, this), isGenerating && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6 bg-blue-50 p-4 rounded-lg border border-blue-200\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"font-medium text-blue-800\",\n          children: \"\\u6B63\\u5728\\u751F\\u6210\\u9884\\u6D4B\\u6570\\u636E...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 670,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm font-medium text-blue-600\",\n          children: [generationProgress, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 671,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 669,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full bg-blue-200 rounded-full h-3\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-blue-600 h-3 rounded-full transition-all duration-300 ease-out\",\n          style: {\n            width: `${generationProgress}%`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 674,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 673,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-2 text-sm text-blue-700\",\n        children: [generationProgress <= 10 && '正在验证数据...', generationProgress > 10 && generationProgress <= 30 && '正在执行拟合算法...', generationProgress > 30 && generationProgress <= 50 && '正在分析最佳拟合结果...', generationProgress > 50 && generationProgress <= 95 && '正在计算预测结果...', generationProgress > 95 && '即将完成...']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 679,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 668,\n      columnNumber: 9\n    }, this), rawData && (localGrayScaleData && localBrightnessBlocks || grayScaleData.values.length > 0 && brightnessBlocks.length > 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: generatePredictions,\n        className: \"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors\",\n        children: \"\\u751F\\u6210\\u9884\\u6D4B\\u7ED3\\u679C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 692,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 691,\n      columnNumber: 9\n    }, this), bestFittingResult && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6 p-4 bg-blue-50 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium mb-2\",\n        children: \"\\u4F7F\\u7528\\u7684\\u6700\\u4F73\\u62DF\\u5408\\u6A21\\u578B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 704,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-4 text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"\\u62DF\\u5408\\u7C7B\\u578B\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 707,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: getTypeLabel(bestFittingResult.type)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 708,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 706,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"R\\xB2\\u503C\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 711,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: bestFittingResult.rSquared.toFixed(6)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 712,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 710,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-span-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"\\u62DF\\u5408\\u516C\\u5F0F\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 715,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium font-mono\",\n            children: bestFittingResult.formula\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 716,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 714,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 705,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 703,\n      columnNumber: 9\n    }, this), rawData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium mb-3\",\n        children: \"\\u539F\\u59CB\\u6570\\u636E\\u70ED\\u529B\\u56FE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 725,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-gray-600 mb-2\",\n        children: \"\\u53CC\\u51FB\\u4EFB\\u610F\\u50CF\\u7D20\\u4F4D\\u7F6E\\u67E5\\u770B\\u8BE5\\u4F4D\\u7F6E\\u7684\\u62DF\\u5408\\u7ED3\\u679C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 726,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inline-block\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            width: `${(((_rawData$matrix$2 = rawData.matrix[0]) === null || _rawData$matrix$2 === void 0 ? void 0 : _rawData$matrix$2.length) || 32) * 24 + 60}`,\n            height: `${rawData.matrix.length * 24 + 60}`,\n            className: \"bg-white\",\n            children: [Array.from({\n              length: ((_rawData$matrix$3 = rawData.matrix[0]) === null || _rawData$matrix$3 === void 0 ? void 0 : _rawData$matrix$3.length) || 32\n            }, (_, colIndex) => /*#__PURE__*/_jsxDEV(\"text\", {\n              x: 30 + colIndex * 24 + 12,\n              y: 15,\n              textAnchor: \"middle\",\n              className: \"text-xs fill-gray-600 font-mono\",\n              children: colIndex\n            }, `col-label-${colIndex}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 740,\n              columnNumber: 19\n            }, this)), rawData.matrix.map((_, rowIndex) => /*#__PURE__*/_jsxDEV(\"text\", {\n              x: 15,\n              y: 30 + rowIndex * 24 + 16,\n              textAnchor: \"middle\",\n              className: \"text-xs fill-gray-600 font-mono\",\n              children: rowIndex\n            }, `row-label-${rowIndex}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 753,\n              columnNumber: 19\n            }, this)), rawData.matrix.map((row, rowIndex) => row.map((value, colIndex) => {\n              const backgroundColor = getColor(value);\n\n              // 根据背景色调整文字颜色\n              const minValue = Math.min(...rawData.matrix.flat());\n              const maxValue = Math.max(...rawData.matrix.flat());\n              const normalizedValue = (value - minValue) / (maxValue - minValue);\n              const textColor = normalizedValue > 0.5 ? 'white' : 'black';\n              return /*#__PURE__*/_jsxDEV(\"g\", {\n                children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n                  x: 30 + colIndex * 24,\n                  y: 30 + rowIndex * 24,\n                  width: \"24\",\n                  height: \"24\",\n                  fill: backgroundColor,\n                  stroke: \"#e5e7eb\",\n                  strokeWidth: \"0.5\",\n                  className: \"cursor-pointer hover:stroke-2 hover:stroke-blue-500\",\n                  onDoubleClick: () => handleDoubleClick(rowIndex, colIndex)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 777,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n                  x: 30 + colIndex * 24 + 12,\n                  y: 30 + rowIndex * 24 + 16,\n                  textAnchor: \"middle\",\n                  className: \"text-xs font-medium pointer-events-none\",\n                  fill: textColor,\n                  children: value.toFixed(1)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 788,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"title\", {\n                  children: `位置: ${numToCol(colIndex + 1)}${rowIndex + 2}, 值: ${value.toFixed(2)}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 797,\n                  columnNumber: 25\n                }, this)]\n              }, `${rowIndex}-${colIndex}`, true, {\n                fileName: _jsxFileName,\n                lineNumber: 776,\n                columnNumber: 23\n              }, this);\n            })), /*#__PURE__*/_jsxDEV(\"text\", {\n              x: `${((((_rawData$matrix$4 = rawData.matrix[0]) === null || _rawData$matrix$4 === void 0 ? void 0 : _rawData$matrix$4.length) || 32) * 24 + 60) / 2}`,\n              y: `${rawData.matrix.length * 24 + 50}`,\n              textAnchor: \"middle\",\n              className: \"text-sm fill-gray-700 font-medium\",\n              children: [\"\\u5217\\u7D22\\u5F15 (0-\", (((_rawData$matrix$5 = rawData.matrix[0]) === null || _rawData$matrix$5 === void 0 ? void 0 : _rawData$matrix$5.length) || 32) - 1, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 804,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n              x: \"15\",\n              y: `${(rawData.matrix.length * 24 + 60) / 2}`,\n              textAnchor: \"middle\",\n              className: \"text-sm fill-gray-700 font-medium\",\n              transform: `rotate(-90 15 ${(rawData.matrix.length * 24 + 60) / 2})`,\n              children: [\"\\u884C\\u7D22\\u5F15 (0-\", rawData.matrix.length - 1, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 812,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 733,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 732,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 731,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 flex items-center gap-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm text-gray-600\",\n          children: \"\\u6570\\u503C\\u8303\\u56F4:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 827,\n          columnNumber: 14\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4\",\n            style: {\n              backgroundColor: getColor(Math.min(...rawData.matrix.flat()))\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 829,\n            columnNumber: 16\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: Math.min(...rawData.matrix.flat()).toFixed(2)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 830,\n            columnNumber: 16\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-20 h-4 bg-gradient-to-r\",\n            style: {\n              backgroundImage: `linear-gradient(to right, ${getColor(Math.min(...rawData.matrix.flat()))}, ${getColor(Math.max(...rawData.matrix.flat()))})`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 831,\n            columnNumber: 16\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: Math.max(...rawData.matrix.flat()).toFixed(2)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 836,\n            columnNumber: 16\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4\",\n            style: {\n              backgroundColor: getColor(Math.max(...rawData.matrix.flat()))\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 837,\n            columnNumber: 16\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 828,\n          columnNumber: 14\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 826,\n        columnNumber: 12\n      }, this), doubleClickedCell && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n        onClick: handleCloseDoubleClickCard,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto\",\n          onClick: e => e.stopPropagation(),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-center mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n              className: \"text-lg font-semibold\",\n              children: [\"\\u4F4D\\u7F6E \", numToCol(doubleClickedCell.col + 1), doubleClickedCell.row + 2, \" \\u8BE6\\u7EC6\\u62DF\\u5408\\u7ED3\\u679C\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 847,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleCloseDoubleClickCard,\n              className: \"text-gray-500 hover:text-gray-700 text-2xl font-bold leading-none\",\n              \"aria-label\": \"\\u5173\\u95ED\",\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 848,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 846,\n            columnNumber: 17\n          }, this), doubleClickPredictionContent]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 845,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 844,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 724,\n      columnNumber: 9\n    }, this), predictionResults.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between items-center mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"font-medium\",\n          children: \"\\u9884\\u6D4B\\u7ED3\\u679C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 867,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: exportToExcel,\n          className: \"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm\",\n          children: \"\\u5BFC\\u51FA\\u5230Excel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 868,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 866,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\",\n        children: predictionResults.map((result, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gradient-to-br from-blue-50 to-indigo-100 p-4 rounded-lg border border-blue-200 hover:shadow-md transition-shadow\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-center mb-2\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-sm font-medium text-gray-600\",\n              children: [\"\\u4F4D\\u7F6E: \", result.position]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 880,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 879,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-600\",\n                children: \"\\u4EAE\\u5EA6\\u503C:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 885,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-medium\",\n                children: result.brightnessValue.toFixed(2)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 886,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 884,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-3 pt-2 border-t border-blue-200\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs font-medium text-gray-700 mb-2\",\n                children: \"\\u5404\\u62DF\\u5408\\u65B9\\u6CD5\\u9884\\u6D4B\\u503C:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 891,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: Object.entries(result.predictions).map(([method, prediction]) => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-white rounded p-2 border\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex justify-between items-center mb-1\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-xs font-medium text-gray-600\",\n                      children: getTypeLabel(method)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 896,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-xs text-blue-600 font-medium\",\n                      children: prediction.predictedGrayScale.toFixed(4)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 899,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 895,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-xs text-gray-500 mb-1\",\n                    children: [\"\\u7F6E\\u4FE1\\u5EA6: \", (prediction.confidence * 100).toFixed(1), \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 903,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-xs text-gray-400 break-all font-mono\",\n                    children: prediction.formula\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 906,\n                    columnNumber: 27\n                  }, this)]\n                }, method, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 894,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 892,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 890,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 883,\n            columnNumber: 17\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 878,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 876,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 p-4 bg-gray-50 rounded-lg\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"font-medium mb-2\",\n          children: \"\\u9884\\u6D4B\\u7EDF\\u8BA1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 920,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-3 gap-4 text-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-gray-600\",\n              children: \"\\u9884\\u6D4B\\u6570\\u636E\\u70B9\\uFF1A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 923,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: predictionResults.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 924,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 922,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-gray-600\",\n              children: \"\\u62DF\\u5408\\u65B9\\u6CD5\\u6570\\uFF1A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 927,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: predictionResults.length > 0 ? Object.keys(predictionResults[0].predictions).length : 0\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 928,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 926,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-gray-600\",\n              children: \"\\u6700\\u4F73\\u62DF\\u5408\\uFF1A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 933,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: bestFittingResult ? getTypeLabel(bestFittingResult.type) : 'N/A'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 934,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 932,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 921,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 919,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 865,\n      columnNumber: 9\n    }, this), !rawData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium mb-2 text-yellow-800\",\n        children: \"\\u4F7F\\u7528\\u8BF4\\u660E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 946,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"text-sm text-yellow-700 space-y-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"1. \\u9996\\u5148\\u786E\\u4FDD\\u5DF2\\u4E0A\\u4F20\\u5E76\\u5904\\u7406\\u4E86\\u539F\\u59CB\\u6570\\u636E\\u6587\\u4EF6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 948,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"2. \\u4E0A\\u4F20\\u5305\\u542BSheet3\\u5DE5\\u4F5C\\u8868\\u7684Excel\\u6587\\u4EF6\\uFF0C\\u76EE\\u6807\\u6570\\u636E\\u5E94\\u4F4D\\u4E8EB\\u5217\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 949,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"3. \\u7CFB\\u7EDF\\u5C06\\u81EA\\u52A8\\u9009\\u62E9\\u6700\\u4F73\\u62DF\\u5408\\u6A21\\u578B\\u8FDB\\u884C\\u9884\\u6D4B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 950,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"4. \\u751F\\u6210\\u9884\\u6D4B\\u7ED3\\u679C\\u540E\\u53EF\\u5BFC\\u51FA\\u5230Excel\\u6587\\u4EF6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 951,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 947,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 945,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 607,\n    columnNumber: 5\n  }, this);\n};\n_s(TargetDataPrediction, \"X3Tk6W/Kg60baQKk/hw0xQuNfC4=\");\n_c = TargetDataPrediction;\nexport default TargetDataPrediction;\nvar _c;\n$RefreshReg$(_c, \"TargetDataPrediction\");","map":{"version":3,"names":["React","useState","useCallback","useMemo","XLSX","performAllFittings","parseExcelData","jsxDEV","_jsxDEV","TargetDataPrediction","grayScaleData","brightnessBlocks","_s","_rawData$matrix$","_rawData$matrix$2","_rawData$matrix$3","_rawData$matrix$4","_rawData$matrix$5","rawData","setRawData","predictionResults","setPredictionResults","bestFittingResult","setBestFittingResult","isLoading","setIsLoading","error","setError","localGrayScaleData","setLocalGrayScaleData","localBrightnessBlocks","setLocalBrightnessBlocks","doubleClickedCell","setDoubleClickedCell","generationProgress","setGenerationProgress","isGenerating","setIsGenerating","cachedPredictionResults","setCachedPredictionResults","getTypeLabel","type","labels","numToCol","num","result","String","fromCharCode","Math","floor","handleFileUpload","event","_event$target$files","file","target","files","parsedData","grayScale","data","arrayBuffer","workbook","read","Uint8Array","SheetNames","includes","Error","worksheet","Sheets","values","positions","startRow","endRow","startCol","endCol","colToNum","col","i","length","charCodeAt","startColNum","endColNum","matrix","row","rowData","colNum","cellAddress","cell","v","undefined","value","parseFloat","toString","isNaN","push","setTimeout","generatePredictions","message","getColor","minValue","min","flat","maxValue","max","normalized","intensity","red","blue","green","abs","handleDoubleClick","rowIndex","colIndex","handleCloseDoubleClickCard","doubleClickPredictionContent","currentGrayScaleData","currentBrightnessBlocks","className","children","fileName","_jsxFileName","lineNumber","columnNumber","cellIndex","cachedResult","rawValue","methodPredictions","predictions","Object","entries","toFixed","map","method","prediction","pred","predictedGrayScale","confidence","formula","Promise","resolve","centerPixelValues","block","centerPixelValue","grayScaleValues","allFittingResults","x","y","bestFitting","reduce","best","current","rSquared","totalValues","predictionCache","index","brightnessValue","forEach","fitting","a","b","coefficients","log","a_exp","b_exp","exp","a_poly","b_poly","c_poly","d_poly","pow","a_pow","b_pow","a_biv","b_biv","c_biv","fittingType","position","progress","err","console","exportToExcel","utils","book_new","rows","cols","colHeaders","originalMatrixData","originalWorksheet","aoa_to_sheet","book_append_sheet","allMethods","Set","keys","add","Array","from","methodMatrixData","dataIndex","methodWorksheet","detailData","detailWorksheet","fittingInfo","rmse","mae","maxError","fittingWs","Date","toISOString","slice","writeFile","accept","onChange","id","htmlFor","style","width","onClick","height","_","textAnchor","backgroundColor","normalizedValue","textColor","fill","stroke","strokeWidth","onDoubleClick","transform","backgroundImage","e","stopPropagation","_c","$RefreshReg$"],"sources":["D:/source/fitdata/fitdata-visualizer/src/components/TargetDataPrediction.tsx"],"sourcesContent":["import React, { useState, useCallback, useMemo } from 'react';\nimport * as XLSX from 'xlsx';\nimport { FittingResult, performAllFittings } from '../utils/curveFitting';\nimport { parseExcelData } from '../utils/dataParser';\n\ninterface RawData {\n  values: number[];\n  positions: string[];\n  matrix: number[][];\n}\n\ninterface CachedPredictionResult {\n  rawValue: number;\n  methodPredictions: {\n    [key: string]: {\n      predictedGrayScale: number;\n      formula: string;\n      confidence: number;\n      fittingType: string;\n    }\n  };\n}\n\ninterface PredictionResult {\n  position: string;\n  brightnessValue: number;\n  predictions: {\n    [key: string]: {\n      predictedGrayScale: number;\n      formula: string;\n      confidence: number;\n      fittingType: string;\n    }\n  };\n}\n\ninterface TargetDataPredictionProps {\n  grayScaleData: {\n    values: number[];\n    positions: string[];\n  };\n  brightnessBlocks: Array<{\n    label: string;\n    startRow: number;\n    endRow: number;\n    data: number[][];\n    centerPixelValue: number;\n    normalizedData?: number[][];\n  }>;\n}\n\nconst TargetDataPrediction: React.FC<TargetDataPredictionProps> = ({ grayScaleData, brightnessBlocks }) => {\n  const [rawData, setRawData] = useState<RawData | null>(null);\n  const [predictionResults, setPredictionResults] = useState<PredictionResult[]>([]);\n  const [bestFittingResult, setBestFittingResult] = useState<FittingResult | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // 本地状态用于存储从文件解析的数据\n  const [localGrayScaleData, setLocalGrayScaleData] = useState<{ values: number[]; positions: string[]; } | null>(null);\n  const [localBrightnessBlocks, setLocalBrightnessBlocks] = useState<Array<{ label: string; startRow: number; endRow: number; data: number[][]; centerPixelValue: number; normalizedData?: number[][]; }> | null>(null);\n\n  const [doubleClickedCell, setDoubleClickedCell] = useState<{ row: number; col: number } | null>(null);\n  const [generationProgress, setGenerationProgress] = useState<number>(0);\n  const [isGenerating, setIsGenerating] = useState<boolean>(false);\n  const [cachedPredictionResults, setCachedPredictionResults] = useState<CachedPredictionResult[] | null>(null);\n\n  // 获取拟合类型标签\n  const getTypeLabel = (type: string) => {\n    const labels: { [key: string]: string } = {\n      'logarithmic': '对数拟合',\n      'exponential': '指数拟合',\n      'polynomial': '三次多项式拟合',\n      'power': '幂函数拟合',\n      'bivariate': '二次多项式拟合'\n    };\n    return labels[type] || type;\n  };\n\n  // 将数字转换为Excel列名\n  const numToCol = (num: number): string => {\n    let result = '';\n    while (num > 0) {\n      num--;\n      result = String.fromCharCode(65 + (num % 26)) + result;\n      num = Math.floor(num / 26);\n    }\n    return result;\n  };\n\n  // 读取Excel Sheet3数据\n  const handleFileUpload = useCallback(async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // 清除缓存的预测结果\n      setCachedPredictionResults(null);\n      \n      // 使用parseExcelData解析完整数据\n      const parsedData = await parseExcelData(file);\n      \n      // 更新本地的grayScaleData和brightnessBlocks\n      setLocalGrayScaleData(parsedData.grayScale);\n      setLocalBrightnessBlocks(parsedData.brightnessBlocks);\n      \n      // 设置原始数据（从Sheet3读取）\n      const data = await file.arrayBuffer();\n      const workbook = XLSX.read(new Uint8Array(data), { type: 'array' });\n      \n      // 检查是否有Sheet3\n      if (!workbook.SheetNames.includes('Sheet3')) {\n        throw new Error('未找到Sheet3工作表');\n      }\n      \n      const worksheet = workbook.Sheets['Sheet3'];\n      const values: number[] = [];\n      const positions: string[] = [];\n      \n      // 读取A2-AF21范围的原始数据（20行×32列）\n      const startRow = 2;\n      const endRow = 21;\n      const startCol = 'A';\n      const endCol = 'AF';\n      \n      // 将列字母转换为数字\n      const colToNum = (col: string): number => {\n        let result = 0;\n        for (let i = 0; i < col.length; i++) {\n          result = result * 26 + (col.charCodeAt(i) - 'A'.charCodeAt(0) + 1);\n        }\n        return result;\n      };\n      \n      const numToCol = (num: number): string => {\n        let result = '';\n        while (num > 0) {\n          num--;\n          result = String.fromCharCode('A'.charCodeAt(0) + (num % 26)) + result;\n          num = Math.floor(num / 26);\n        }\n        return result;\n      };\n      \n      const startColNum = colToNum(startCol);\n      const endColNum = colToNum(endCol);\n      \n      // 创建矩阵结构\n      const matrix: number[][] = [];\n      \n      // 按行读取数据\n      for (let row = startRow; row <= endRow; row++) {\n        const rowData: number[] = [];\n        for (let colNum = startColNum; colNum <= endColNum; colNum++) {\n          const col = numToCol(colNum);\n          const cellAddress = `${col}${row}`;\n          const cell = worksheet[cellAddress];\n          \n          if (cell && cell.v !== undefined && cell.v !== null && cell.v !== '') {\n            const value = typeof cell.v === 'number' ? cell.v : parseFloat(cell.v.toString());\n            if (!isNaN(value)) {\n              values.push(value);\n              positions.push(cellAddress);\n              rowData.push(value);\n            } else {\n              rowData.push(0);\n            }\n          } else {\n            rowData.push(0);\n          }\n        }\n        matrix.push(rowData);\n      }\n      \n      if (values.length === 0) {\n        throw new Error('Sheet3中未找到有效的原始数据');\n      }\n      \n      setRawData({ values, positions, matrix });\n      \n      // 自动生成预测结果（延迟确保状态更新完成）\n      setTimeout(async () => {\n        await generatePredictions();\n      }, 100);\n    } catch (error) {\n      setError(error instanceof Error ? error.message : '文件读取失败');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n\n\n  // 获取颜色值\n  const getColor = (value: number) => {\n    if (!rawData || !rawData.matrix || rawData.matrix.length === 0) {\n      return 'rgb(255, 255, 255)';\n    }\n    \n    const minValue = Math.min(...rawData.matrix.flat());\n    const maxValue = Math.max(...rawData.matrix.flat());\n    \n    if (maxValue === minValue) return 'rgb(255, 255, 255)';\n    \n    const normalized = (value - minValue) / (maxValue - minValue);\n    const intensity = Math.floor(normalized * 255);\n    \n    // 使用蓝色到红色的渐变\n    const red = intensity;\n    const blue = 255 - intensity;\n    const green = Math.floor(128 * (1 - Math.abs(normalized - 0.5) * 2));\n    \n    return `rgb(${red}, ${green}, ${blue})`;\n  };\n\n  // 处理双击事件\n  const handleDoubleClick = useCallback((rowIndex: number, colIndex: number) => {\n    // 如果没有缓存的预测结果，提示用户先生成预测数据\n    if (!cachedPredictionResults) {\n      setError('请先生成预测数据后再查看详细结果');\n      return;\n    }\n    setDoubleClickedCell({ row: rowIndex, col: colIndex });\n  }, [cachedPredictionResults]);\n\n  // 关闭双击卡片\n  const handleCloseDoubleClickCard = useCallback(() => {\n    setDoubleClickedCell(null);\n  }, []);\n\n  // 计算双击卡片的预测结果\n  const doubleClickPredictionContent = useMemo(() => {\n    // 使用本地数据（如果有）或传入的props数据\n    const currentGrayScaleData = localGrayScaleData || grayScaleData;\n    const currentBrightnessBlocks = localBrightnessBlocks || brightnessBlocks;\n    \n    if (!rawData || !currentGrayScaleData.values.length || !currentBrightnessBlocks.length || !doubleClickedCell) {\n      return <p className=\"text-gray-500\">预测数据尚未生成，请等待数据处理完成</p>;\n    }\n    \n    // 使用缓存的预测结果，如果没有缓存则返回提示\n    if (!cachedPredictionResults) {\n      return <p className=\"text-gray-500\">请先生成预测数据</p>;\n    }\n    \n    // 直接从缓存中读取该位置的预测结果\n    const cellIndex = doubleClickedCell.row * 32 + doubleClickedCell.col;\n    const cachedResult = cachedPredictionResults[cellIndex];\n    \n    if (!cachedResult) {\n      return <p className=\"text-gray-500\">该位置暂无有效拟合结果</p>;\n    }\n    \n    const { rawValue, methodPredictions } = cachedResult;\n    const predictions = Object.entries(methodPredictions);\n    \n    if (predictions.length === 0) {\n      return <p className=\"text-gray-500\">该位置暂无有效拟合结果</p>;\n    }\n    \n    return (\n      <div className=\"space-y-4\">\n        <div className=\"bg-gray-50 p-4 rounded-lg\">\n          <div className=\"text-sm mb-2\">\n            <span className=\"text-gray-600\">亮度值:</span>\n            <span className=\"ml-2 font-medium\">{rawValue.toFixed(2)}</span>\n          </div>\n        </div>\n        \n        <div>\n          <h6 className=\"font-medium text-gray-700 mb-3\">所有拟合方法预测结果:</h6>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full border-collapse border border-gray-200\">\n              <thead>\n                <tr className=\"bg-gray-100\">\n                  <th className=\"border border-gray-200 px-3 py-2 text-left font-medium\">拟合类型</th>\n                  <th className=\"border border-gray-200 px-3 py-2 text-left font-medium\">预测结果</th>\n                  <th className=\"border border-gray-200 px-3 py-2 text-left font-medium\">置信度(R²)</th>\n                  <th className=\"border border-gray-200 px-3 py-2 text-left font-medium\">拟合公式</th>\n                </tr>\n              </thead>\n              <tbody>\n                {predictions.map(([method, prediction]) => {\n                  const pred = prediction as {\n                    predictedGrayScale: number;\n                    formula: string;\n                    confidence: number;\n                    fittingType: string;\n                  };\n                  return (\n                    <tr key={method} className=\"hover:bg-gray-50\">\n                      <td className=\"border border-gray-200 px-3 py-2\">\n                        <span className=\"font-medium text-gray-700\">\n                          {getTypeLabel(method)}\n                        </span>\n                      </td>\n                      <td className=\"border border-gray-200 px-3 py-2\">\n                        <span className=\"text-lg font-bold text-blue-600\">\n                          {pred.predictedGrayScale.toFixed(6)}\n                        </span>\n                      </td>\n                      <td className=\"border border-gray-200 px-3 py-2\">\n                        <span className=\"font-medium\">\n                          {(pred.confidence * 100).toFixed(2)}%\n                        </span>\n                      </td>\n                      <td className=\"border border-gray-200 px-3 py-2\">\n                        <div className=\"text-sm font-mono text-gray-600 max-w-xs break-all\">\n                          {pred.formula}\n                        </div>\n                      </td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    );\n  }, [doubleClickedCell, cachedPredictionResults, localGrayScaleData, localBrightnessBlocks, grayScaleData, brightnessBlocks, rawData, getTypeLabel]);\n\n  // 生成预测结果\n  const generatePredictions = useCallback(async () => {\n    if (!rawData) {\n      setError('请先上传原始数据');\n      return;\n    }\n\n    // 使用本地数据（如果有）或传入的props数据\n    const currentGrayScaleData = localGrayScaleData || grayScaleData;\n    const currentBrightnessBlocks = localBrightnessBlocks || brightnessBlocks;\n\n    if (!currentGrayScaleData.values.length || !currentBrightnessBlocks.length) {\n      setError('无法获取有效的拟合数据');\n      return;\n    }\n\n    setIsGenerating(true);\n    setGenerationProgress(0);\n    setError(null);\n\n    try {\n      // 步骤1: 数据验证 (10%)\n      setGenerationProgress(10);\n      await new Promise(resolve => setTimeout(resolve, 100));\n\n      // 提取中心像素值和灰阶值\n      const centerPixelValues = currentBrightnessBlocks.map(block => block.centerPixelValue);\n      const grayScaleValues = currentGrayScaleData.values;\n\n      if (centerPixelValues.length !== grayScaleValues.length) {\n        setError('拟合数据长度不匹配');\n        return;\n      }\n\n      // 步骤2: 执行拟合算法 (30%)\n      setGenerationProgress(30);\n      await new Promise(resolve => setTimeout(resolve, 200));\n\n      const allFittingResults = performAllFittings({\n        x: centerPixelValues,\n        y: grayScaleValues\n      });\n\n      // 拟合结果已获取，继续处理预测\n\n      // 步骤3: 找到最佳拟合结果 (50%)\n      setGenerationProgress(50);\n      await new Promise(resolve => setTimeout(resolve, 100));\n\n      const bestFitting = allFittingResults.reduce((best, current) => {\n        if (isNaN(current.rSquared) || current.rSquared < 0) return best;\n        if (!best || current.rSquared > best.rSquared) return current;\n        return best;\n      }, null as FittingResult | null);\n\n      if (!bestFitting) {\n        setError('无法获取有效的拟合结果');\n        return;\n      }\n\n      setBestFittingResult(bestFitting);\n\n      // 步骤4: 计算预测结果 (80%)\n      setGenerationProgress(80);\n      await new Promise(resolve => setTimeout(resolve, 300));\n\n      const totalValues = rawData.values.length;\n      const predictions: PredictionResult[] = [];\n      const predictionCache: CachedPredictionResult[] = [];\n\n      for (let index = 0; index < totalValues; index++) {\n        const rawValue = rawData.values[index];\n        // 计算对应的亮度值\n        let brightnessValue = rawValue; // 使用原始数据值作为亮度值\n\n        // 为每种拟合方法计算预测值\n        const methodPredictions: { [key: string]: { predictedGrayScale: number; formula: string; confidence: number; fittingType: string } } = {};\n        \n        allFittingResults.forEach(fitting => {\n          if (isNaN(fitting.rSquared) || fitting.rSquared < 0) return;\n          \n          let predictedGrayScale = 0;\n          \n          // 根据拟合类型计算预测值\n          switch (fitting.type) {\n            case 'logarithmic':\n              if (rawValue > 0) {\n                const [a, b] = fitting.coefficients;\n                predictedGrayScale = a * Math.log(rawValue) + b;\n              }\n              break;\n            case 'exponential':\n              const [a_exp, b_exp] = fitting.coefficients;\n              predictedGrayScale = a_exp * Math.exp(b_exp * rawValue);\n              break;\n            case 'polynomial':\n              const [a_poly, b_poly, c_poly, d_poly] = fitting.coefficients;\n              predictedGrayScale = a_poly * Math.pow(rawValue, 3) + \n                                  b_poly * Math.pow(rawValue, 2) + \n                                  c_poly * rawValue + d_poly;\n              break;\n            case 'power':\n              if (rawValue > 0) {\n                const [a_pow, b_pow] = fitting.coefficients;\n                predictedGrayScale = a_pow * Math.pow(rawValue, b_pow);\n              }\n              break;\n            case 'bivariate':\n              const [a_biv, b_biv, c_biv] = fitting.coefficients;\n              predictedGrayScale = a_biv * Math.pow(rawValue, 2) + \n                                  b_biv * rawValue + c_biv;\n              break;\n          }\n\n          methodPredictions[fitting.type] = {\n            predictedGrayScale,\n            formula: fitting.formula,\n            confidence: fitting.rSquared,\n            fittingType: fitting.type\n          };\n        });\n\n        predictions.push({\n          position: rawData.positions[index],\n          brightnessValue,\n          predictions: methodPredictions\n        });\n\n        // 缓存该位置的预测结果供双击功能使用\n        predictionCache.push({\n          rawValue,\n          methodPredictions\n        });\n\n        // 更新进度 (80% - 95%)\n        const progress = 80 + Math.floor((index / totalValues) * 15);\n        setGenerationProgress(progress);\n        \n        // 每处理100个数据点暂停一下，让UI更新\n        if (index % 100 === 0) {\n          await new Promise(resolve => setTimeout(resolve, 10));\n        }\n      }\n\n      // 缓存预测结果\n      setCachedPredictionResults(predictionCache);\n\n      // 步骤5: 完成 (100%)\n      setGenerationProgress(100);\n      await new Promise(resolve => setTimeout(resolve, 200));\n\n      setPredictionResults(predictions);\n      setError(null);\n    } catch (err) {\n      console.error('预测生成错误:', err);\n      setError(err instanceof Error ? err.message : '预测生成失败');\n    } finally {\n      setIsGenerating(false);\n      setGenerationProgress(0);\n    }\n  }, [rawData, grayScaleData, brightnessBlocks, localGrayScaleData, localBrightnessBlocks, getTypeLabel]);\n\n  // 导出预测结果到Excel\n  const exportToExcel = useCallback(() => {\n    if (predictionResults.length === 0 || !rawData) {\n      setError('没有预测结果可导出');\n      return;\n    }\n\n    const workbook = XLSX.utils.book_new();\n    \n    // 创建矩阵格式的预测结果工作表\n    const rows = 20; // A2-AF21 共20行\n    const cols = 32; // A-AF 共32列\n    \n    // 将列数字转换为字母的辅助函数\n    const numToCol = (num: number): string => {\n      let result = '';\n      while (num > 0) {\n        num--;\n        result = String.fromCharCode('A'.charCodeAt(0) + (num % 26)) + result;\n        num = Math.floor(num / 26);\n      }\n      return result;\n    };\n    \n    // 创建列标题 (A-AF)\n    const colHeaders: string[] = [];\n    for (let i = 0; i < cols; i++) {\n      colHeaders.push(numToCol(i + 1));\n    }\n    \n    // 创建原始数据矩阵工作表\n    const originalMatrixData = [];\n    originalMatrixData.push(['', ...colHeaders]);\n    \n    for (let row = 0; row < rows; row++) {\n      const rowData: (string | number)[] = [row + 2]; // 行号从2开始\n      for (let col = 0; col < cols; col++) {\n        if (row < rawData.matrix.length && col < rawData.matrix[row].length) {\n          rowData.push(rawData.matrix[row][col]);\n        } else {\n          rowData.push('');\n        }\n      }\n      originalMatrixData.push(rowData);\n    }\n    \n    const originalWorksheet = XLSX.utils.aoa_to_sheet(originalMatrixData);\n    XLSX.utils.book_append_sheet(workbook, originalWorksheet, '原始数据');\n    \n    // 获取所有拟合方法\n    const allMethods = new Set<string>();\n    predictionResults.forEach(result => {\n      Object.keys(result.predictions).forEach(method => allMethods.add(method));\n    });\n    \n    // 为每种拟合方法创建单独的预测结果矩阵\n    Array.from(allMethods).forEach(method => {\n      const methodMatrixData: (string | number)[][] = [];\n      methodMatrixData.push(['', ...colHeaders]);\n      \n      for (let row = 0; row < rows; row++) {\n        const rowData: (string | number)[] = [row + 2]; // 行号从2开始\n        for (let col = 0; col < cols; col++) {\n          const dataIndex = row * cols + col;\n          if (dataIndex < predictionResults.length && predictionResults[dataIndex].predictions[method]) {\n            rowData.push(parseFloat(predictionResults[dataIndex].predictions[method].predictedGrayScale.toFixed(6)));\n          } else {\n            rowData.push('');\n          }\n        }\n        methodMatrixData.push(rowData);\n      }\n      \n      const methodWorksheet = XLSX.utils.aoa_to_sheet(methodMatrixData);\n      XLSX.utils.book_append_sheet(workbook, methodWorksheet, getTypeLabel(method));\n    });\n    \n    // 创建详细预测结果工作表\n    const detailData: any[] = [];\n    detailData.push(['位置', '亮度值', '拟合方法', '预测灰阶值', '置信度(R²)', '拟合公式']);\n    \n    predictionResults.forEach(result => {\n      Object.entries(result.predictions).forEach(([method, prediction]) => {\n        detailData.push([\n          result.position,\n          result.brightnessValue.toFixed(2),\n          getTypeLabel(method),\n          prediction.predictedGrayScale.toFixed(6),\n          prediction.confidence.toFixed(6),\n          prediction.formula\n        ]);\n      });\n    });\n    \n    const detailWorksheet = XLSX.utils.aoa_to_sheet(detailData);\n    XLSX.utils.book_append_sheet(workbook, detailWorksheet, '详细结果');\n    \n    // 添加拟合信息工作表\n    if (bestFittingResult) {\n      const fittingInfo = [\n        ['拟合信息', ''],\n        ['最佳拟合类型', getTypeLabel(bestFittingResult.type)],\n        ['拟合公式', bestFittingResult.formula],\n        ['R²值', bestFittingResult.rSquared.toFixed(6)],\n        ['RMSE', bestFittingResult.rmse.toFixed(6)],\n        ['MAE', bestFittingResult.mae.toFixed(6)],\n        ['最大误差', bestFittingResult.maxError.toFixed(6)]\n      ];\n      \n      const fittingWs = XLSX.utils.aoa_to_sheet(fittingInfo);\n      XLSX.utils.book_append_sheet(workbook, fittingWs, '拟合信息');\n    }\n    \n    // 下载文件\n    const fileName = `原始数据预测结果_${new Date().toISOString().slice(0, 10)}.xlsx`;\n    XLSX.writeFile(workbook, fileName);\n  }, [predictionResults, bestFittingResult, rawData]);\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-lg p-6\">\n      <h3 className=\"text-lg font-semibold mb-6\">原始数据预测</h3>\n      \n      {/* 文件上传区域 */}\n      <div className=\"mb-6\">\n        <h4 className=\"font-medium mb-3\">上传原始数据文件 (Sheet3)</h4>\n        <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center\">\n          <input\n            type=\"file\"\n            accept=\".xlsx,.xls\"\n            onChange={handleFileUpload}\n            className=\"hidden\"\n            id=\"raw-file-upload\"\n          />\n          <label\n            htmlFor=\"raw-file-upload\"\n            className=\"cursor-pointer inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors\"\n          >\n            选择Excel文件\n          </label>\n          <p className=\"mt-2 text-sm text-gray-500\">\n            请选择包含Sheet3工作表的Excel文件，原始数据应位于A2-AF21范围\n          </p>\n        </div>\n      </div>\n\n      {/* 加载状态 */}\n      {isLoading && (\n        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n          <p className=\"text-blue-700\">正在读取文件...</p>\n        </div>\n      )}\n\n      {/* 错误信息 */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg\">\n          <p className=\"text-red-700\">{error}</p>\n        </div>\n      )}\n\n      {/* 原始数据概览 */}\n      {rawData && (\n        <div className=\"mb-6 p-4 bg-gray-50 rounded-lg\">\n          <h4 className=\"font-medium mb-2\">原始数据概览</h4>\n          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n            <div>\n              <span className=\"text-gray-600\">矩阵维度:</span>\n              <span className=\"ml-2 font-medium\">{rawData.matrix.length} × {rawData.matrix[0]?.length || 0}</span>\n            </div>\n            <div>\n              <span className=\"text-gray-600\">数值范围:</span>\n              <span className=\"ml-2 font-medium\">\n                {Math.min(...rawData.matrix.flat()).toFixed(2)} - {Math.max(...rawData.matrix.flat()).toFixed(2)}\n              </span>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* 预测生成进度 */}\n      {isGenerating && (\n        <div className=\"mb-6 bg-blue-50 p-4 rounded-lg border border-blue-200\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <h4 className=\"font-medium text-blue-800\">正在生成预测数据...</h4>\n            <span className=\"text-sm font-medium text-blue-600\">{generationProgress}%</span>\n          </div>\n          <div className=\"w-full bg-blue-200 rounded-full h-3\">\n            <div \n              className=\"bg-blue-600 h-3 rounded-full transition-all duration-300 ease-out\"\n              style={{ width: `${generationProgress}%` }}\n            ></div>\n          </div>\n          <div className=\"mt-2 text-sm text-blue-700\">\n            {generationProgress <= 10 && '正在验证数据...'}\n            {generationProgress > 10 && generationProgress <= 30 && '正在执行拟合算法...'}\n            {generationProgress > 30 && generationProgress <= 50 && '正在分析最佳拟合结果...'}\n            {generationProgress > 50 && generationProgress <= 95 && '正在计算预测结果...'}\n            {generationProgress > 95 && '即将完成...'}\n          </div>\n        </div>\n      )}\n\n      {/* 生成预测按钮 */}\n      {rawData && ((localGrayScaleData && localBrightnessBlocks) || (grayScaleData.values.length > 0 && brightnessBlocks.length > 0)) && (\n        <div className=\"mb-6\">\n          <button\n            onClick={generatePredictions}\n            className=\"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors\"\n          >\n            生成预测结果\n          </button>\n        </div>\n      )}\n\n      {/* 最佳拟合信息 */}\n      {bestFittingResult && (\n        <div className=\"mb-6 p-4 bg-blue-50 rounded-lg\">\n          <h4 className=\"font-medium mb-2\">使用的最佳拟合模型</h4>\n          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n            <div>\n              <span className=\"text-gray-600\">拟合类型：</span>\n              <span className=\"font-medium\">{getTypeLabel(bestFittingResult.type)}</span>\n            </div>\n            <div>\n              <span className=\"text-gray-600\">R²值：</span>\n              <span className=\"font-medium\">{bestFittingResult.rSquared.toFixed(6)}</span>\n            </div>\n            <div className=\"col-span-2\">\n              <span className=\"text-gray-600\">拟合公式：</span>\n              <span className=\"font-medium font-mono\">{bestFittingResult.formula}</span>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* 原始数据热力图 */}\n      {rawData && (\n        <div className=\"mb-6\">\n          <h4 className=\"font-medium mb-3\">原始数据热力图</h4>\n          <p className=\"text-sm text-gray-600 mb-2\">\n            双击任意像素位置查看该位置的拟合结果\n          </p>\n          \n          {/* SVG热力图 */}\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200 overflow-x-auto\">\n            <div className=\"inline-block\">\n              <svg \n                width={`${(rawData.matrix[0]?.length || 32) * 24 + 60}`} \n                height={`${rawData.matrix.length * 24 + 60}`} \n                className=\"bg-white\"\n              >\n                {/* 列标识 (顶部) */}\n                {Array.from({ length: rawData.matrix[0]?.length || 32 }, (_, colIndex) => (\n                  <text\n                    key={`col-label-${colIndex}`}\n                    x={30 + colIndex * 24 + 12}\n                    y={15}\n                    textAnchor=\"middle\"\n                    className=\"text-xs fill-gray-600 font-mono\"\n                  >\n                    {colIndex}\n                  </text>\n                ))}\n                \n                {/* 行标识 (左侧) */}\n                {rawData.matrix.map((_, rowIndex) => (\n                  <text\n                    key={`row-label-${rowIndex}`}\n                    x={15}\n                    y={30 + rowIndex * 24 + 16}\n                    textAnchor=\"middle\"\n                    className=\"text-xs fill-gray-600 font-mono\"\n                  >\n                    {rowIndex}\n                  </text>\n                ))}\n                \n                {/* 热力图数据 */}\n                {rawData.matrix.map((row, rowIndex) =>\n                  row.map((value, colIndex) => {\n                    const backgroundColor = getColor(value);\n                    \n                    // 根据背景色调整文字颜色\n                    const minValue = Math.min(...rawData.matrix.flat());\n                    const maxValue = Math.max(...rawData.matrix.flat());\n                    const normalizedValue = (value - minValue) / (maxValue - minValue);\n                    const textColor = normalizedValue > 0.5 ? 'white' : 'black';\n                    \n                    return (\n                      <g key={`${rowIndex}-${colIndex}`}>\n                        <rect\n                          x={30 + colIndex * 24}\n                          y={30 + rowIndex * 24}\n                          width=\"24\"\n                          height=\"24\"\n                          fill={backgroundColor}\n                          stroke=\"#e5e7eb\"\n                          strokeWidth=\"0.5\"\n                          className=\"cursor-pointer hover:stroke-2 hover:stroke-blue-500\"\n                          onDoubleClick={() => handleDoubleClick(rowIndex, colIndex)}\n                        />\n                        <text\n                          x={30 + colIndex * 24 + 12}\n                          y={30 + rowIndex * 24 + 16}\n                          textAnchor=\"middle\"\n                          className=\"text-xs font-medium pointer-events-none\"\n                          fill={textColor}\n                        >\n                          {value.toFixed(1)}\n                        </text>\n                        <title>{`位置: ${numToCol(colIndex + 1)}${rowIndex + 2}, 值: ${value.toFixed(2)}`}</title>\n                      </g>\n                    );\n                  })\n                )}\n                \n                {/* 坐标轴标签 */}\n                <text \n                  x={`${((rawData.matrix[0]?.length || 32) * 24 + 60) / 2}`} \n                  y={`${rawData.matrix.length * 24 + 50}`} \n                  textAnchor=\"middle\" \n                  className=\"text-sm fill-gray-700 font-medium\"\n                >\n                  列索引 (0-{(rawData.matrix[0]?.length || 32) - 1})\n                </text>\n                <text \n                  x=\"15\" \n                  y={`${(rawData.matrix.length * 24 + 60) / 2}`} \n                  textAnchor=\"middle\" \n                  className=\"text-sm fill-gray-700 font-medium\" \n                  transform={`rotate(-90 15 ${(rawData.matrix.length * 24 + 60) / 2})`}\n                >\n                  行索引 (0-{rawData.matrix.length - 1})\n                </text>\n              </svg>\n            </div>\n          </div>\n          \n          {/* 颜色图例 */}\n           <div className=\"mt-4 flex items-center gap-4\">\n             <span className=\"text-sm text-gray-600\">数值范围:</span>\n             <div className=\"flex items-center gap-2\">\n               <div className=\"w-4 h-4\" style={{ backgroundColor: getColor(Math.min(...rawData.matrix.flat())) }}></div>\n               <span className=\"text-xs\">{Math.min(...rawData.matrix.flat()).toFixed(2)}</span>\n               <div className=\"w-20 h-4 bg-gradient-to-r\" \n                    style={{ \n                      backgroundImage: `linear-gradient(to right, ${getColor(Math.min(...rawData.matrix.flat()))}, ${getColor(Math.max(...rawData.matrix.flat()))})` \n                    }}>\n               </div>\n               <span className=\"text-xs\">{Math.max(...rawData.matrix.flat()).toFixed(2)}</span>\n               <div className=\"w-4 h-4\" style={{ backgroundColor: getColor(Math.max(...rawData.matrix.flat())) }}></div>\n             </div>\n           </div>\n\n          \n          {/* 双击拟合结果卡片 */}\n          {doubleClickedCell && (\n            <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\" onClick={handleCloseDoubleClickCard}>\n              <div className=\"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto\" onClick={(e) => e.stopPropagation()}>\n                <div className=\"flex justify-between items-center mb-4\">\n                  <h5 className=\"text-lg font-semibold\">位置 {numToCol(doubleClickedCell.col + 1)}{doubleClickedCell.row + 2} 详细拟合结果</h5>\n                  <button\n                    onClick={handleCloseDoubleClickCard}\n                    className=\"text-gray-500 hover:text-gray-700 text-2xl font-bold leading-none\"\n                    aria-label=\"关闭\"\n                  >\n                    ×\n                  </button>\n                </div>\n                {doubleClickPredictionContent}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* 预测结果 */}\n      {predictionResults.length > 0 && (\n        <div className=\"mb-6\">\n          <div className=\"flex justify-between items-center mb-3\">\n            <h4 className=\"font-medium\">预测结果</h4>\n            <button\n              onClick={exportToExcel}\n              className=\"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm\"\n            >\n              导出到Excel\n            </button>\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\n            {predictionResults.map((result, index) => (\n              <div key={index} className=\"bg-gradient-to-br from-blue-50 to-indigo-100 p-4 rounded-lg border border-blue-200 hover:shadow-md transition-shadow\">\n                <div className=\"flex justify-between items-center mb-2\">\n                  <span className=\"text-sm font-medium text-gray-600\">位置: {result.position}</span>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-sm text-gray-600\">亮度值:</span>\n                    <span className=\"text-sm font-medium\">{result.brightnessValue.toFixed(2)}</span>\n                  </div>\n                  \n                  {/* 显示所有拟合方法的预测结果 */}\n                  <div className=\"mt-3 pt-2 border-t border-blue-200\">\n                    <div className=\"text-xs font-medium text-gray-700 mb-2\">各拟合方法预测值:</div>\n                    <div className=\"space-y-2\">\n                      {Object.entries(result.predictions).map(([method, prediction]) => (\n                        <div key={method} className=\"bg-white rounded p-2 border\">\n                          <div className=\"flex justify-between items-center mb-1\">\n                            <span className=\"text-xs font-medium text-gray-600\">\n                              {getTypeLabel(method)}\n                            </span>\n                            <span className=\"text-xs text-blue-600 font-medium\">\n                              {prediction.predictedGrayScale.toFixed(4)}\n                            </span>\n                          </div>\n                          <div className=\"text-xs text-gray-500 mb-1\">\n                            置信度: {(prediction.confidence * 100).toFixed(1)}%\n                          </div>\n                          <div className=\"text-xs text-gray-400 break-all font-mono\">\n                            {prediction.formula}\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n          \n          {/* 统计信息 */}\n          <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n            <h5 className=\"font-medium mb-2\">预测统计</h5>\n            <div className=\"grid grid-cols-3 gap-4 text-sm\">\n              <div>\n                <span className=\"text-gray-600\">预测数据点：</span>\n                <span className=\"font-medium\">{predictionResults.length}</span>\n              </div>\n              <div>\n                <span className=\"text-gray-600\">拟合方法数：</span>\n                <span className=\"font-medium\">\n                  {predictionResults.length > 0 ? Object.keys(predictionResults[0].predictions).length : 0}\n                </span>\n              </div>\n              <div>\n                <span className=\"text-gray-600\">最佳拟合：</span>\n                <span className=\"font-medium\">\n                  {bestFittingResult ? getTypeLabel(bestFittingResult.type) : 'N/A'}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* 使用说明 */}\n      {!rawData && (\n        <div className=\"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\n          <h4 className=\"font-medium mb-2 text-yellow-800\">使用说明</h4>\n          <ul className=\"text-sm text-yellow-700 space-y-1\">\n            <li>1. 首先确保已上传并处理了原始数据文件</li>\n            <li>2. 上传包含Sheet3工作表的Excel文件，目标数据应位于B列</li>\n            <li>3. 系统将自动选择最佳拟合模型进行预测</li>\n            <li>4. 生成预测结果后可导出到Excel文件</li>\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TargetDataPrediction;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
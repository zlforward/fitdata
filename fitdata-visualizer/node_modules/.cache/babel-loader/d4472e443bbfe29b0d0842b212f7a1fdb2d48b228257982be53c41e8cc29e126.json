{"ast":null,"code":"var _jsxFileName = \"D:\\\\source\\\\fitdata\\\\fitdata-visualizer\\\\src\\\\components\\\\TargetDataPrediction.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useCallback } from 'react';\nimport * as XLSX from 'xlsx';\nimport { performAllFittings } from '../utils/curveFitting';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TargetDataPrediction = ({\n  grayScaleData,\n  brightnessBlocks\n}) => {\n  _s();\n  const [targetData, setTargetData] = useState(null);\n  const [predictionResults, setPredictionResults] = useState([]);\n  const [bestFittingResult, setBestFittingResult] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // 读取Excel Sheet3数据\n  const handleFileUpload = useCallback(event => {\n    var _event$target$files;\n    const file = (_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0];\n    if (!file) return;\n    setIsLoading(true);\n    setError(null);\n    const reader = new FileReader();\n    reader.onload = e => {\n      try {\n        var _e$target;\n        const data = new Uint8Array((_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.result);\n        const workbook = XLSX.read(data, {\n          type: 'array'\n        });\n\n        // 检查是否有Sheet3\n        if (!workbook.SheetNames.includes('Sheet3')) {\n          throw new Error('未找到Sheet3工作表');\n        }\n        const worksheet = workbook.Sheets['Sheet3'];\n        const values = [];\n        const positions = [];\n\n        // 读取A2-AF21范围的目标数据（20行×32列）\n        const startRow = 2;\n        const endRow = 21;\n        const startCol = 'A';\n        const endCol = 'AF';\n\n        // 将列字母转换为数字\n        const colToNum = col => {\n          let result = 0;\n          for (let i = 0; i < col.length; i++) {\n            result = result * 26 + (col.charCodeAt(i) - 'A'.charCodeAt(0) + 1);\n          }\n          return result;\n        };\n        const numToCol = num => {\n          let result = '';\n          while (num > 0) {\n            num--;\n            result = String.fromCharCode('A'.charCodeAt(0) + num % 26) + result;\n            num = Math.floor(num / 26);\n          }\n          return result;\n        };\n        const startColNum = colToNum(startCol);\n        const endColNum = colToNum(endCol);\n\n        // 按行读取数据\n        for (let row = startRow; row <= endRow; row++) {\n          for (let colNum = startColNum; colNum <= endColNum; colNum++) {\n            const col = numToCol(colNum);\n            const cellAddress = `${col}${row}`;\n            const cell = worksheet[cellAddress];\n            if (cell && cell.v !== undefined && cell.v !== null && cell.v !== '') {\n              const value = typeof cell.v === 'number' ? cell.v : parseFloat(cell.v.toString());\n              if (!isNaN(value)) {\n                values.push(value);\n                positions.push(cellAddress);\n              }\n            }\n          }\n        }\n        if (values.length === 0) {\n          throw new Error('Sheet3中未找到有效的目标数据');\n        }\n        setTargetData({\n          values,\n          positions\n        });\n      } catch (error) {\n        setError(error instanceof Error ? error.message : '文件读取失败');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    reader.onerror = () => {\n      setError('文件读取失败');\n      setIsLoading(false);\n    };\n    reader.readAsArrayBuffer(file);\n  }, []);\n\n  // 获取最佳拟合结果\n  const getBestFittingResult = useCallback(() => {\n    if (!grayScaleData.values.length || !brightnessBlocks.length) {\n      return null;\n    }\n\n    // 提取中心像素值和灰阶值\n    const centerPixelValues = brightnessBlocks.map(block => block.centerPixelValue);\n    const grayScaleValues = grayScaleData.values;\n    if (centerPixelValues.length !== grayScaleValues.length) {\n      return null;\n    }\n\n    // 执行所有拟合算法\n    const fittingResults = performAllFittings({\n      x: centerPixelValues,\n      y: grayScaleValues\n    });\n\n    // 找到R²值最高的拟合结果\n    const bestResult = fittingResults.reduce((best, current) => {\n      if (isNaN(current.rSquared) || current.rSquared < 0) return best;\n      if (!best || current.rSquared > best.rSquared) return current;\n      return best;\n    }, null);\n    return bestResult;\n  }, [grayScaleData, brightnessBlocks]);\n\n  // 生成预测结果\n  const generatePredictions = useCallback(() => {\n    if (!targetData) {\n      setError('请先上传目标数据');\n      return;\n    }\n    const bestFitting = getBestFittingResult();\n    if (!bestFitting) {\n      setError('无法获取有效的拟合结果');\n      return;\n    }\n    setBestFittingResult(bestFitting);\n    const predictions = targetData.values.map((targetValue, index) => {\n      let predictedGrayScale = 0;\n\n      // 根据拟合类型计算预测值\n      switch (bestFitting.type) {\n        case 'logarithmic':\n          if (targetValue > 0) {\n            const [a, b] = bestFitting.coefficients;\n            predictedGrayScale = a * Math.log(targetValue) + b;\n          }\n          break;\n        case 'exponential':\n          const [a_exp, b_exp] = bestFitting.coefficients;\n          predictedGrayScale = a_exp * Math.exp(b_exp * targetValue);\n          break;\n        case 'polynomial':\n          const [a_poly, b_poly, c_poly, d_poly] = bestFitting.coefficients;\n          predictedGrayScale = a_poly * Math.pow(targetValue, 3) + b_poly * Math.pow(targetValue, 2) + c_poly * targetValue + d_poly;\n          break;\n        case 'power':\n          if (targetValue > 0) {\n            const [a_pow, b_pow] = bestFitting.coefficients;\n            predictedGrayScale = a_pow * Math.pow(targetValue, b_pow);\n          }\n          break;\n        case 'bivariate':\n          const [a_biv, b_biv, c_biv] = bestFitting.coefficients;\n          predictedGrayScale = a_biv * Math.pow(targetValue, 2) + b_biv * targetValue + c_biv;\n          break;\n      }\n\n      // 计算对应的亮度值（使用反向拟合）\n      let brightnessValue = 0;\n      if (index < brightnessBlocks.length) {\n        brightnessValue = brightnessBlocks[index].centerPixelValue;\n      }\n\n      // 计算误差（预测值与实际目标值的差异）\n      const error = Math.abs(predictedGrayScale - targetValue);\n      return {\n        targetValue,\n        position: targetData.positions[index],\n        predictedGrayScale,\n        brightnessValue,\n        bestFittingType: bestFitting.type,\n        confidence: bestFitting.rSquared,\n        formula: bestFitting.formula,\n        error\n      };\n    });\n    setPredictionResults(predictions);\n    setError(null);\n  }, [targetData, getBestFittingResult]);\n\n  // 导出预测结果到Excel\n  const exportToExcel = useCallback(() => {\n    if (predictionResults.length === 0 || !targetData) {\n      setError('没有预测结果可导出');\n      return;\n    }\n    const workbook = XLSX.utils.book_new();\n\n    // 创建矩阵格式的预测结果工作表\n    const rows = 20; // A2-AF21 共20行\n    const cols = 32; // A-AF 共32列\n\n    // 创建列标题 (A-AF)\n    const colHeaders = [];\n    for (let i = 0; i < cols; i++) {\n      colHeaders.push(numToCol(i + 1));\n    }\n\n    // 初始化数据矩阵\n    const matrixData = [];\n\n    // 添加列标题行\n    matrixData.push(['', ...colHeaders]);\n\n    // 创建原始目标数据矩阵\n    for (let row = 0; row < rows; row++) {\n      const rowData = [row + 2]; // 行号从2开始\n      for (let col = 0; col < cols; col++) {\n        const dataIndex = row * cols + col;\n        if (dataIndex < targetData.values.length) {\n          rowData.push(targetData.values[dataIndex]);\n        } else {\n          rowData.push('');\n        }\n      }\n      matrixData.push(rowData);\n    }\n\n    // 添加分隔行\n    matrixData.push(['']);\n    matrixData.push(['预测结果矩阵']);\n    matrixData.push(['', ...colHeaders]);\n\n    // 创建预测结果矩阵\n    for (let row = 0; row < rows; row++) {\n      const rowData = [row + 2]; // 行号从2开始\n      for (let col = 0; col < cols; col++) {\n        const dataIndex = row * cols + col;\n        if (dataIndex < predictionResults.length) {\n          rowData.push(predictionResults[dataIndex].predictedGrayScale.toFixed(6));\n        } else {\n          rowData.push('');\n        }\n      }\n      matrixData.push(rowData);\n    }\n\n    // 添加分隔行和误差矩阵\n    matrixData.push(['']);\n    matrixData.push(['误差矩阵']);\n    matrixData.push(['', ...colHeaders]);\n\n    // 创建误差矩阵\n    for (let row = 0; row < rows; row++) {\n      const rowData = [row + 2]; // 行号从2开始\n      for (let col = 0; col < cols; col++) {\n        const dataIndex = row * cols + col;\n        if (dataIndex < predictionResults.length) {\n          rowData.push(predictionResults[dataIndex].error.toFixed(6));\n        } else {\n          rowData.push('');\n        }\n      }\n      matrixData.push(rowData);\n    }\n    const worksheet = XLSX.utils.aoa_to_sheet(matrixData);\n    XLSX.utils.book_append_sheet(workbook, worksheet, '矩阵结果');\n\n    // 创建详细预测结果工作表\n    const detailData = [['位置', '目标数据值', '预测灰阶值', '亮度值', '误差', '拟合类型', '置信度(R²)', '拟合公式'], ...predictionResults.map(result => [result.position, result.targetValue, result.predictedGrayScale.toFixed(6), result.brightnessValue.toFixed(2), result.error.toFixed(6), getTypeLabel(result.bestFittingType), result.confidence.toFixed(6), result.formula])];\n    const detailWorksheet = XLSX.utils.aoa_to_sheet(detailData);\n    XLSX.utils.book_append_sheet(workbook, detailWorksheet, '详细结果');\n\n    // 添加拟合信息工作表\n    if (bestFittingResult) {\n      const fittingInfo = [['拟合信息', ''], ['拟合类型', getTypeLabel(bestFittingResult.type)], ['拟合公式', bestFittingResult.formula], ['R²值', bestFittingResult.rSquared.toFixed(6)], ['RMSE', bestFittingResult.rmse.toFixed(6)], ['MAE', bestFittingResult.mae.toFixed(6)], ['最大误差', bestFittingResult.maxError.toFixed(6)]];\n      const fittingWs = XLSX.utils.aoa_to_sheet(fittingInfo);\n      XLSX.utils.book_append_sheet(workbook, fittingWs, '拟合信息');\n    }\n\n    // 下载文件\n    const fileName = `目标数据预测结果_${new Date().toISOString().slice(0, 10)}.xlsx`;\n    XLSX.writeFile(workbook, fileName);\n  }, [predictionResults, bestFittingResult, targetData]);\n\n  // 获取拟合类型标签\n  const getTypeLabel = type => {\n    const labels = {\n      'logarithmic': '对数拟合',\n      'exponential': '指数拟合',\n      'polynomial': '三次多项式拟合',\n      'power': '幂函数拟合',\n      'bivariate': '二次多项式拟合'\n    };\n    return labels[type] || type;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white rounded-lg shadow-lg p-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"text-lg font-semibold mb-6\",\n      children: \"\\u76EE\\u6807\\u6570\\u636E\\u9884\\u6D4B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium mb-3\",\n        children: \"\\u4E0A\\u4F20\\u76EE\\u6807\\u6570\\u636E\\u6587\\u4EF6 (Sheet3)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \".xlsx,.xls\",\n          onChange: handleFileUpload,\n          className: \"hidden\",\n          id: \"target-file-upload\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"target-file-upload\",\n          className: \"cursor-pointer inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors\",\n          children: \"\\u9009\\u62E9Excel\\u6587\\u4EF6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-2 text-sm text-gray-500\",\n          children: \"\\u8BF7\\u9009\\u62E9\\u5305\\u542BSheet3\\u5DE5\\u4F5C\\u8868\\u7684Excel\\u6587\\u4EF6\\uFF0C\\u76EE\\u6807\\u6570\\u636E\\u5E94\\u4F4D\\u4E8EB\\u5217\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 7\n    }, this), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-blue-700\",\n        children: \"\\u6B63\\u5728\\u8BFB\\u53D6\\u6587\\u4EF6...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-red-700\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 9\n    }, this), targetData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6 p-4 bg-gray-50 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium mb-2\",\n        children: \"\\u76EE\\u6807\\u6570\\u636E\\u6982\\u89C8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-4 text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"\\u6570\\u636E\\u70B9\\u6570\\u91CF\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 414,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: targetData.values.length\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 415,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"\\u6570\\u503C\\u8303\\u56F4\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: [Math.min(...targetData.values).toFixed(2), \" - \", Math.max(...targetData.values).toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 419,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 9\n    }, this), targetData && grayScaleData.values.length > 0 && brightnessBlocks.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: generatePredictions,\n        className: \"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors\",\n        children: \"\\u751F\\u6210\\u9884\\u6D4B\\u7ED3\\u679C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 9\n    }, this), bestFittingResult && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6 p-4 bg-blue-50 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium mb-2\",\n        children: \"\\u4F7F\\u7528\\u7684\\u6700\\u4F73\\u62DF\\u5408\\u6A21\\u578B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-4 text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"\\u62DF\\u5408\\u7C7B\\u578B\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: getTypeLabel(bestFittingResult.type)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 444,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"R\\xB2\\u503C\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: bestFittingResult.rSquared.toFixed(6)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 450,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-span-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-600\",\n            children: \"\\u62DF\\u5408\\u516C\\u5F0F\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium font-mono\",\n            children: bestFittingResult.formula\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 9\n    }, this), predictionResults.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between items-center mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"font-medium\",\n          children: \"\\u9884\\u6D4B\\u7ED3\\u679C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 464,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: exportToExcel,\n          className: \"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm\",\n          children: \"\\u5BFC\\u51FA\\u5230Excel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\",\n        children: predictionResults.map((result, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gradient-to-br from-blue-50 to-indigo-100 p-4 rounded-lg border border-blue-200 hover:shadow-md transition-shadow\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-center mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-sm font-medium text-gray-600\",\n              children: [\"\\u4F4D\\u7F6E: \", result.position]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 477,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded\",\n              children: getTypeLabel(result.bestFittingType)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 478,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-600\",\n                children: \"\\u4EAE\\u5EA6\\u503C:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 483,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-medium\",\n                children: result.brightnessValue.toFixed(2)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 484,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 482,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-600\",\n                children: \"\\u76EE\\u6807\\u503C:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 488,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-medium\",\n                children: result.targetValue.toFixed(4)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 489,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-600\",\n                children: \"\\u9884\\u6D4B\\u503C:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 493,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-medium text-blue-600\",\n                children: result.predictedGrayScale.toFixed(4)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 494,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 492,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-600\",\n                children: \"\\u8BEF\\u5DEE:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 498,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `text-sm font-medium ${result.error < 0.1 ? 'text-green-600' : result.error < 0.5 ? 'text-yellow-600' : 'text-red-600'}`,\n                children: result.error.toFixed(4)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 499,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-3 pt-2 border-t border-blue-200\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-500 mb-1\",\n                children: \"\\u62DF\\u5408\\u516C\\u5F0F:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 508,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs font-mono bg-white p-2 rounded border text-gray-700\",\n                children: result.formula\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 509,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 507,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between mt-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs text-gray-500\",\n                children: \"\\u7F6E\\u4FE1\\u5EA6:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 515,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `text-xs font-medium px-2 py-1 rounded-full ${result.confidence > 0.9 ? 'bg-green-100 text-green-800' : result.confidence > 0.7 ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}`,\n                children: [(result.confidence * 100).toFixed(2), \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 516,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 481,\n            columnNumber: 17\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 473,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 p-4 bg-gray-50 rounded-lg\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"font-medium mb-2\",\n          children: \"\\u9884\\u6D4B\\u7EDF\\u8BA1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-3 gap-4 text-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-gray-600\",\n              children: \"\\u9884\\u6D4B\\u6570\\u636E\\u70B9\\uFF1A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 534,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: predictionResults.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 535,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 533,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-gray-600\",\n              children: \"\\u5E73\\u5747\\u9884\\u6D4B\\u503C\\uFF1A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 538,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: (predictionResults.reduce((sum, r) => sum + r.predictedGrayScale, 0) / predictionResults.length).toFixed(4)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 539,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-gray-600\",\n              children: \"\\u9884\\u6D4B\\u8303\\u56F4\\uFF1A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: [Math.min(...predictionResults.map(r => r.predictedGrayScale)).toFixed(4), \" -\", Math.max(...predictionResults.map(r => r.predictedGrayScale)).toFixed(4)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 545,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 543,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 462,\n      columnNumber: 9\n    }, this), !targetData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium mb-2 text-yellow-800\",\n        children: \"\\u4F7F\\u7528\\u8BF4\\u660E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 558,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"text-sm text-yellow-700 space-y-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"1. \\u9996\\u5148\\u786E\\u4FDD\\u5DF2\\u4E0A\\u4F20\\u5E76\\u5904\\u7406\\u4E86\\u539F\\u59CB\\u6570\\u636E\\u6587\\u4EF6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"2. \\u4E0A\\u4F20\\u5305\\u542BSheet3\\u5DE5\\u4F5C\\u8868\\u7684Excel\\u6587\\u4EF6\\uFF0C\\u76EE\\u6807\\u6570\\u636E\\u5E94\\u4F4D\\u4E8EB\\u5217\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 561,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"3. \\u7CFB\\u7EDF\\u5C06\\u81EA\\u52A8\\u9009\\u62E9\\u6700\\u4F73\\u62DF\\u5408\\u6A21\\u578B\\u8FDB\\u884C\\u9884\\u6D4B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"4. \\u751F\\u6210\\u9884\\u6D4B\\u7ED3\\u679C\\u540E\\u53EF\\u5BFC\\u51FA\\u5230Excel\\u6587\\u4EF6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 563,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 559,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 557,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 368,\n    columnNumber: 5\n  }, this);\n};\n_s(TargetDataPrediction, \"G/zmSAQlZir2VFw+YYJiGYtZVl4=\");\n_c = TargetDataPrediction;\nexport default TargetDataPrediction;\nvar _c;\n$RefreshReg$(_c, \"TargetDataPrediction\");","map":{"version":3,"names":["React","useState","useCallback","XLSX","performAllFittings","jsxDEV","_jsxDEV","TargetDataPrediction","grayScaleData","brightnessBlocks","_s","targetData","setTargetData","predictionResults","setPredictionResults","bestFittingResult","setBestFittingResult","isLoading","setIsLoading","error","setError","handleFileUpload","event","_event$target$files","file","target","files","reader","FileReader","onload","e","_e$target","data","Uint8Array","result","workbook","read","type","SheetNames","includes","Error","worksheet","Sheets","values","positions","startRow","endRow","startCol","endCol","colToNum","col","i","length","charCodeAt","numToCol","num","String","fromCharCode","Math","floor","startColNum","endColNum","row","colNum","cellAddress","cell","v","undefined","value","parseFloat","toString","isNaN","push","message","onerror","readAsArrayBuffer","getBestFittingResult","centerPixelValues","map","block","centerPixelValue","grayScaleValues","fittingResults","x","y","bestResult","reduce","best","current","rSquared","generatePredictions","bestFitting","predictions","targetValue","index","predictedGrayScale","a","b","coefficients","log","a_exp","b_exp","exp","a_poly","b_poly","c_poly","d_poly","pow","a_pow","b_pow","a_biv","b_biv","c_biv","brightnessValue","abs","position","bestFittingType","confidence","formula","exportToExcel","utils","book_new","rows","cols","colHeaders","matrixData","rowData","dataIndex","toFixed","aoa_to_sheet","book_append_sheet","detailData","getTypeLabel","detailWorksheet","fittingInfo","rmse","mae","maxError","fittingWs","fileName","Date","toISOString","slice","writeFile","labels","className","children","_jsxFileName","lineNumber","columnNumber","accept","onChange","id","htmlFor","min","max","onClick","sum","r","_c","$RefreshReg$"],"sources":["D:/source/fitdata/fitdata-visualizer/src/components/TargetDataPrediction.tsx"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport * as XLSX from 'xlsx';\nimport { FittingResult, performAllFittings } from '../utils/curveFitting';\nimport { ParsedData } from '../utils/dataParser';\n\ninterface TargetData {\n  values: number[];\n  positions: string[];\n}\n\ninterface PredictionResult {\n  targetValue: number;\n  position: string;\n  predictedGrayScale: number;\n  brightnessValue: number;\n  bestFittingType: string;\n  confidence: number;\n  formula: string;\n  error: number;\n}\n\ninterface TargetDataPredictionProps {\n  grayScaleData: {\n    values: number[];\n    positions: string[];\n  };\n  brightnessBlocks: Array<{\n    label: string;\n    startRow: number;\n    endRow: number;\n    data: number[][];\n    centerPixelValue: number;\n    normalizedData?: number[][];\n  }>;\n}\n\nconst TargetDataPrediction: React.FC<TargetDataPredictionProps> = ({ grayScaleData, brightnessBlocks }) => {\n  const [targetData, setTargetData] = useState<TargetData | null>(null);\n  const [predictionResults, setPredictionResults] = useState<PredictionResult[]>([]);\n  const [bestFittingResult, setBestFittingResult] = useState<FittingResult | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // 读取Excel Sheet3数据\n  const handleFileUpload = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    setIsLoading(true);\n    setError(null);\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      try {\n        const data = new Uint8Array(e.target?.result as ArrayBuffer);\n        const workbook = XLSX.read(data, { type: 'array' });\n        \n        // 检查是否有Sheet3\n        if (!workbook.SheetNames.includes('Sheet3')) {\n          throw new Error('未找到Sheet3工作表');\n        }\n        \n        const worksheet = workbook.Sheets['Sheet3'];\n        const values: number[] = [];\n        const positions: string[] = [];\n        \n        // 读取A2-AF21范围的目标数据（20行×32列）\n        const startRow = 2;\n        const endRow = 21;\n        const startCol = 'A';\n        const endCol = 'AF';\n        \n        // 将列字母转换为数字\n        const colToNum = (col: string): number => {\n          let result = 0;\n          for (let i = 0; i < col.length; i++) {\n            result = result * 26 + (col.charCodeAt(i) - 'A'.charCodeAt(0) + 1);\n          }\n          return result;\n        };\n        \n        const numToCol = (num: number): string => {\n          let result = '';\n          while (num > 0) {\n            num--;\n            result = String.fromCharCode('A'.charCodeAt(0) + (num % 26)) + result;\n            num = Math.floor(num / 26);\n          }\n          return result;\n        };\n        \n        const startColNum = colToNum(startCol);\n        const endColNum = colToNum(endCol);\n        \n        // 按行读取数据\n        for (let row = startRow; row <= endRow; row++) {\n          for (let colNum = startColNum; colNum <= endColNum; colNum++) {\n            const col = numToCol(colNum);\n            const cellAddress = `${col}${row}`;\n            const cell = worksheet[cellAddress];\n            \n            if (cell && cell.v !== undefined && cell.v !== null && cell.v !== '') {\n              const value = typeof cell.v === 'number' ? cell.v : parseFloat(cell.v.toString());\n              if (!isNaN(value)) {\n                values.push(value);\n                positions.push(cellAddress);\n              }\n            }\n          }\n        }\n        \n        if (values.length === 0) {\n          throw new Error('Sheet3中未找到有效的目标数据');\n        }\n        \n        setTargetData({ values, positions });\n      } catch (error) {\n        setError(error instanceof Error ? error.message : '文件读取失败');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    \n    reader.onerror = () => {\n      setError('文件读取失败');\n      setIsLoading(false);\n    };\n    \n    reader.readAsArrayBuffer(file);\n  }, []);\n\n  // 获取最佳拟合结果\n  const getBestFittingResult = useCallback((): FittingResult | null => {\n    if (!grayScaleData.values.length || !brightnessBlocks.length) {\n      return null;\n    }\n\n    // 提取中心像素值和灰阶值\n    const centerPixelValues = brightnessBlocks.map(block => block.centerPixelValue);\n    const grayScaleValues = grayScaleData.values;\n\n    if (centerPixelValues.length !== grayScaleValues.length) {\n      return null;\n    }\n\n    // 执行所有拟合算法\n    const fittingResults = performAllFittings({\n      x: centerPixelValues,\n      y: grayScaleValues\n    });\n\n    // 找到R²值最高的拟合结果\n    const bestResult = fittingResults.reduce((best, current) => {\n      if (isNaN(current.rSquared) || current.rSquared < 0) return best;\n      if (!best || current.rSquared > best.rSquared) return current;\n      return best;\n    }, null as FittingResult | null);\n\n    return bestResult;\n  }, [grayScaleData, brightnessBlocks]);\n\n  // 生成预测结果\n  const generatePredictions = useCallback(() => {\n    if (!targetData) {\n      setError('请先上传目标数据');\n      return;\n    }\n\n    const bestFitting = getBestFittingResult();\n    if (!bestFitting) {\n      setError('无法获取有效的拟合结果');\n      return;\n    }\n\n    setBestFittingResult(bestFitting);\n\n    const predictions: PredictionResult[] = targetData.values.map((targetValue, index) => {\n      let predictedGrayScale = 0;\n      \n      // 根据拟合类型计算预测值\n      switch (bestFitting.type) {\n        case 'logarithmic':\n          if (targetValue > 0) {\n            const [a, b] = bestFitting.coefficients;\n            predictedGrayScale = a * Math.log(targetValue) + b;\n          }\n          break;\n        case 'exponential':\n          const [a_exp, b_exp] = bestFitting.coefficients;\n          predictedGrayScale = a_exp * Math.exp(b_exp * targetValue);\n          break;\n        case 'polynomial':\n          const [a_poly, b_poly, c_poly, d_poly] = bestFitting.coefficients;\n          predictedGrayScale = a_poly * Math.pow(targetValue, 3) + \n                              b_poly * Math.pow(targetValue, 2) + \n                              c_poly * targetValue + d_poly;\n          break;\n        case 'power':\n          if (targetValue > 0) {\n            const [a_pow, b_pow] = bestFitting.coefficients;\n            predictedGrayScale = a_pow * Math.pow(targetValue, b_pow);\n          }\n          break;\n        case 'bivariate':\n          const [a_biv, b_biv, c_biv] = bestFitting.coefficients;\n          predictedGrayScale = a_biv * Math.pow(targetValue, 2) + \n                              b_biv * targetValue + c_biv;\n          break;\n      }\n\n      // 计算对应的亮度值（使用反向拟合）\n      let brightnessValue = 0;\n      if (index < brightnessBlocks.length) {\n        brightnessValue = brightnessBlocks[index].centerPixelValue;\n      }\n\n      // 计算误差（预测值与实际目标值的差异）\n      const error = Math.abs(predictedGrayScale - targetValue);\n\n      return {\n        targetValue,\n        position: targetData.positions[index],\n        predictedGrayScale,\n        brightnessValue,\n        bestFittingType: bestFitting.type,\n        confidence: bestFitting.rSquared,\n        formula: bestFitting.formula,\n        error\n      };\n    });\n\n    setPredictionResults(predictions);\n    setError(null);\n  }, [targetData, getBestFittingResult]);\n\n  // 导出预测结果到Excel\n  const exportToExcel = useCallback(() => {\n    if (predictionResults.length === 0 || !targetData) {\n      setError('没有预测结果可导出');\n      return;\n    }\n\n    const workbook = XLSX.utils.book_new();\n    \n    // 创建矩阵格式的预测结果工作表\n    const rows = 20; // A2-AF21 共20行\n    const cols = 32; // A-AF 共32列\n    \n    // 创建列标题 (A-AF)\n    const colHeaders = [];\n    for (let i = 0; i < cols; i++) {\n      colHeaders.push(numToCol(i + 1));\n    }\n    \n    // 初始化数据矩阵\n    const matrixData = [];\n    \n    // 添加列标题行\n    matrixData.push(['', ...colHeaders]);\n    \n    // 创建原始目标数据矩阵\n    for (let row = 0; row < rows; row++) {\n      const rowData = [row + 2]; // 行号从2开始\n      for (let col = 0; col < cols; col++) {\n        const dataIndex = row * cols + col;\n        if (dataIndex < targetData.values.length) {\n          rowData.push(targetData.values[dataIndex]);\n        } else {\n          rowData.push('');\n        }\n      }\n      matrixData.push(rowData);\n    }\n    \n    // 添加分隔行\n    matrixData.push(['']);\n    matrixData.push(['预测结果矩阵']);\n    matrixData.push(['', ...colHeaders]);\n    \n    // 创建预测结果矩阵\n    for (let row = 0; row < rows; row++) {\n      const rowData = [row + 2]; // 行号从2开始\n      for (let col = 0; col < cols; col++) {\n        const dataIndex = row * cols + col;\n        if (dataIndex < predictionResults.length) {\n          rowData.push(predictionResults[dataIndex].predictedGrayScale.toFixed(6));\n        } else {\n          rowData.push('');\n        }\n      }\n      matrixData.push(rowData);\n    }\n    \n    // 添加分隔行和误差矩阵\n    matrixData.push(['']);\n    matrixData.push(['误差矩阵']);\n    matrixData.push(['', ...colHeaders]);\n    \n    // 创建误差矩阵\n    for (let row = 0; row < rows; row++) {\n      const rowData = [row + 2]; // 行号从2开始\n      for (let col = 0; col < cols; col++) {\n        const dataIndex = row * cols + col;\n        if (dataIndex < predictionResults.length) {\n          rowData.push(predictionResults[dataIndex].error.toFixed(6));\n        } else {\n          rowData.push('');\n        }\n      }\n      matrixData.push(rowData);\n    }\n    \n    const worksheet = XLSX.utils.aoa_to_sheet(matrixData);\n    XLSX.utils.book_append_sheet(workbook, worksheet, '矩阵结果');\n    \n    // 创建详细预测结果工作表\n    const detailData = [\n      ['位置', '目标数据值', '预测灰阶值', '亮度值', '误差', '拟合类型', '置信度(R²)', '拟合公式'],\n      ...predictionResults.map(result => [\n        result.position,\n        result.targetValue,\n        result.predictedGrayScale.toFixed(6),\n        result.brightnessValue.toFixed(2),\n        result.error.toFixed(6),\n        getTypeLabel(result.bestFittingType),\n        result.confidence.toFixed(6),\n        result.formula\n      ])\n    ];\n    \n    const detailWorksheet = XLSX.utils.aoa_to_sheet(detailData);\n    XLSX.utils.book_append_sheet(workbook, detailWorksheet, '详细结果');\n    \n    // 添加拟合信息工作表\n    if (bestFittingResult) {\n      const fittingInfo = [\n        ['拟合信息', ''],\n        ['拟合类型', getTypeLabel(bestFittingResult.type)],\n        ['拟合公式', bestFittingResult.formula],\n        ['R²值', bestFittingResult.rSquared.toFixed(6)],\n        ['RMSE', bestFittingResult.rmse.toFixed(6)],\n        ['MAE', bestFittingResult.mae.toFixed(6)],\n        ['最大误差', bestFittingResult.maxError.toFixed(6)]\n      ];\n      \n      const fittingWs = XLSX.utils.aoa_to_sheet(fittingInfo);\n      XLSX.utils.book_append_sheet(workbook, fittingWs, '拟合信息');\n    }\n    \n    // 下载文件\n    const fileName = `目标数据预测结果_${new Date().toISOString().slice(0, 10)}.xlsx`;\n    XLSX.writeFile(workbook, fileName);\n  }, [predictionResults, bestFittingResult, targetData]);\n\n  // 获取拟合类型标签\n  const getTypeLabel = (type: string) => {\n    const labels: { [key: string]: string } = {\n      'logarithmic': '对数拟合',\n      'exponential': '指数拟合',\n      'polynomial': '三次多项式拟合',\n      'power': '幂函数拟合',\n      'bivariate': '二次多项式拟合'\n    };\n    return labels[type] || type;\n  };\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-lg p-6\">\n      <h3 className=\"text-lg font-semibold mb-6\">目标数据预测</h3>\n      \n      {/* 文件上传区域 */}\n      <div className=\"mb-6\">\n        <h4 className=\"font-medium mb-3\">上传目标数据文件 (Sheet3)</h4>\n        <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center\">\n          <input\n            type=\"file\"\n            accept=\".xlsx,.xls\"\n            onChange={handleFileUpload}\n            className=\"hidden\"\n            id=\"target-file-upload\"\n          />\n          <label\n            htmlFor=\"target-file-upload\"\n            className=\"cursor-pointer inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors\"\n          >\n            选择Excel文件\n          </label>\n          <p className=\"mt-2 text-sm text-gray-500\">\n            请选择包含Sheet3工作表的Excel文件，目标数据应位于B列\n          </p>\n        </div>\n      </div>\n\n      {/* 加载状态 */}\n      {isLoading && (\n        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n          <p className=\"text-blue-700\">正在读取文件...</p>\n        </div>\n      )}\n\n      {/* 错误信息 */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg\">\n          <p className=\"text-red-700\">{error}</p>\n        </div>\n      )}\n\n      {/* 目标数据概览 */}\n      {targetData && (\n        <div className=\"mb-6 p-4 bg-gray-50 rounded-lg\">\n          <h4 className=\"font-medium mb-2\">目标数据概览</h4>\n          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n            <div>\n              <span className=\"text-gray-600\">数据点数量：</span>\n              <span className=\"font-medium\">{targetData.values.length}</span>\n            </div>\n            <div>\n              <span className=\"text-gray-600\">数值范围：</span>\n              <span className=\"font-medium\">\n                {Math.min(...targetData.values).toFixed(2)} - {Math.max(...targetData.values).toFixed(2)}\n              </span>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* 生成预测按钮 */}\n      {targetData && grayScaleData.values.length > 0 && brightnessBlocks.length > 0 && (\n        <div className=\"mb-6\">\n          <button\n            onClick={generatePredictions}\n            className=\"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors\"\n          >\n            生成预测结果\n          </button>\n        </div>\n      )}\n\n      {/* 最佳拟合信息 */}\n      {bestFittingResult && (\n        <div className=\"mb-6 p-4 bg-blue-50 rounded-lg\">\n          <h4 className=\"font-medium mb-2\">使用的最佳拟合模型</h4>\n          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n            <div>\n              <span className=\"text-gray-600\">拟合类型：</span>\n              <span className=\"font-medium\">{getTypeLabel(bestFittingResult.type)}</span>\n            </div>\n            <div>\n              <span className=\"text-gray-600\">R²值：</span>\n              <span className=\"font-medium\">{bestFittingResult.rSquared.toFixed(6)}</span>\n            </div>\n            <div className=\"col-span-2\">\n              <span className=\"text-gray-600\">拟合公式：</span>\n              <span className=\"font-medium font-mono\">{bestFittingResult.formula}</span>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* 预测结果数据块 */}\n      {predictionResults.length > 0 && (\n        <div className=\"mb-6\">\n          <div className=\"flex justify-between items-center mb-3\">\n            <h4 className=\"font-medium\">预测结果</h4>\n            <button\n              onClick={exportToExcel}\n              className=\"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm\"\n            >\n              导出到Excel\n            </button>\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\n            {predictionResults.map((result, index) => (\n              <div key={index} className=\"bg-gradient-to-br from-blue-50 to-indigo-100 p-4 rounded-lg border border-blue-200 hover:shadow-md transition-shadow\">\n                <div className=\"flex justify-between items-center mb-2\">\n                  <span className=\"text-sm font-medium text-gray-600\">位置: {result.position}</span>\n                  <span className=\"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded\">{getTypeLabel(result.bestFittingType)}</span>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-sm text-gray-600\">亮度值:</span>\n                    <span className=\"text-sm font-medium\">{result.brightnessValue.toFixed(2)}</span>\n                  </div>\n                  \n                  <div className=\"flex justify-between\">\n                    <span className=\"text-sm text-gray-600\">目标值:</span>\n                    <span className=\"text-sm font-medium\">{result.targetValue.toFixed(4)}</span>\n                  </div>\n                  \n                  <div className=\"flex justify-between\">\n                    <span className=\"text-sm text-gray-600\">预测值:</span>\n                    <span className=\"text-sm font-medium text-blue-600\">{result.predictedGrayScale.toFixed(4)}</span>\n                  </div>\n                  \n                  <div className=\"flex justify-between\">\n                    <span className=\"text-sm text-gray-600\">误差:</span>\n                    <span className={`text-sm font-medium ${\n                      result.error < 0.1 ? 'text-green-600' : \n                      result.error < 0.5 ? 'text-yellow-600' : 'text-red-600'\n                    }`}>\n                      {result.error.toFixed(4)}\n                    </span>\n                  </div>\n                  \n                  <div className=\"mt-3 pt-2 border-t border-blue-200\">\n                    <div className=\"text-xs text-gray-500 mb-1\">拟合公式:</div>\n                    <div className=\"text-xs font-mono bg-white p-2 rounded border text-gray-700\">\n                      {result.formula}\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex justify-between mt-2\">\n                    <span className=\"text-xs text-gray-500\">置信度:</span>\n                    <span className={`text-xs font-medium px-2 py-1 rounded-full ${\n                      result.confidence > 0.9 ? 'bg-green-100 text-green-800' :\n                      result.confidence > 0.7 ? 'bg-yellow-100 text-yellow-800' :\n                      'bg-red-100 text-red-800'\n                    }`}>\n                      {(result.confidence * 100).toFixed(2)}%\n                    </span>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n          \n          {/* 统计信息 */}\n          <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n            <h5 className=\"font-medium mb-2\">预测统计</h5>\n            <div className=\"grid grid-cols-3 gap-4 text-sm\">\n              <div>\n                <span className=\"text-gray-600\">预测数据点：</span>\n                <span className=\"font-medium\">{predictionResults.length}</span>\n              </div>\n              <div>\n                <span className=\"text-gray-600\">平均预测值：</span>\n                <span className=\"font-medium\">\n                  {(predictionResults.reduce((sum, r) => sum + r.predictedGrayScale, 0) / predictionResults.length).toFixed(4)}\n                </span>\n              </div>\n              <div>\n                <span className=\"text-gray-600\">预测范围：</span>\n                <span className=\"font-medium\">\n                  {Math.min(...predictionResults.map(r => r.predictedGrayScale)).toFixed(4)} - \n                  {Math.max(...predictionResults.map(r => r.predictedGrayScale)).toFixed(4)}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* 使用说明 */}\n      {!targetData && (\n        <div className=\"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\n          <h4 className=\"font-medium mb-2 text-yellow-800\">使用说明</h4>\n          <ul className=\"text-sm text-yellow-700 space-y-1\">\n            <li>1. 首先确保已上传并处理了原始数据文件</li>\n            <li>2. 上传包含Sheet3工作表的Excel文件，目标数据应位于B列</li>\n            <li>3. 系统将自动选择最佳拟合模型进行预测</li>\n            <li>4. 生成预测结果后可导出到Excel文件</li>\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TargetDataPrediction;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AACpD,OAAO,KAAKC,IAAI,MAAM,MAAM;AAC5B,SAAwBC,kBAAkB,QAAQ,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAkC1E,MAAMC,oBAAyD,GAAGA,CAAC;EAAEC,aAAa;EAAEC;AAAiB,CAAC,KAAK;EAAAC,EAAA;EACzG,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGX,QAAQ,CAAoB,IAAI,CAAC;EACrE,MAAM,CAACY,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGb,QAAQ,CAAqB,EAAE,CAAC;EAClF,MAAM,CAACc,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGf,QAAQ,CAAuB,IAAI,CAAC;EACtF,MAAM,CAACgB,SAAS,EAAEC,YAAY,CAAC,GAAGjB,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACkB,KAAK,EAAEC,QAAQ,CAAC,GAAGnB,QAAQ,CAAgB,IAAI,CAAC;;EAEvD;EACA,MAAMoB,gBAAgB,GAAGnB,WAAW,CAAEoB,KAA0C,IAAK;IAAA,IAAAC,mBAAA;IACnF,MAAMC,IAAI,IAAAD,mBAAA,GAAGD,KAAK,CAACG,MAAM,CAACC,KAAK,cAAAH,mBAAA,uBAAlBA,mBAAA,CAAqB,CAAC,CAAC;IACpC,IAAI,CAACC,IAAI,EAAE;IAEXN,YAAY,CAAC,IAAI,CAAC;IAClBE,QAAQ,CAAC,IAAI,CAAC;IAEd,MAAMO,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;IAC/BD,MAAM,CAACE,MAAM,GAAIC,CAAC,IAAK;MACrB,IAAI;QAAA,IAAAC,SAAA;QACF,MAAMC,IAAI,GAAG,IAAIC,UAAU,EAAAF,SAAA,GAACD,CAAC,CAACL,MAAM,cAAAM,SAAA,uBAARA,SAAA,CAAUG,MAAqB,CAAC;QAC5D,MAAMC,QAAQ,GAAGhC,IAAI,CAACiC,IAAI,CAACJ,IAAI,EAAE;UAAEK,IAAI,EAAE;QAAQ,CAAC,CAAC;;QAEnD;QACA,IAAI,CAACF,QAAQ,CAACG,UAAU,CAACC,QAAQ,CAAC,QAAQ,CAAC,EAAE;UAC3C,MAAM,IAAIC,KAAK,CAAC,cAAc,CAAC;QACjC;QAEA,MAAMC,SAAS,GAAGN,QAAQ,CAACO,MAAM,CAAC,QAAQ,CAAC;QAC3C,MAAMC,MAAgB,GAAG,EAAE;QAC3B,MAAMC,SAAmB,GAAG,EAAE;;QAE9B;QACA,MAAMC,QAAQ,GAAG,CAAC;QAClB,MAAMC,MAAM,GAAG,EAAE;QACjB,MAAMC,QAAQ,GAAG,GAAG;QACpB,MAAMC,MAAM,GAAG,IAAI;;QAEnB;QACA,MAAMC,QAAQ,GAAIC,GAAW,IAAa;UACxC,IAAIhB,MAAM,GAAG,CAAC;UACd,KAAK,IAAIiB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,GAAG,CAACE,MAAM,EAAED,CAAC,EAAE,EAAE;YACnCjB,MAAM,GAAGA,MAAM,GAAG,EAAE,IAAIgB,GAAG,CAACG,UAAU,CAACF,CAAC,CAAC,GAAG,GAAG,CAACE,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;UACpE;UACA,OAAOnB,MAAM;QACf,CAAC;QAED,MAAMoB,QAAQ,GAAIC,GAAW,IAAa;UACxC,IAAIrB,MAAM,GAAG,EAAE;UACf,OAAOqB,GAAG,GAAG,CAAC,EAAE;YACdA,GAAG,EAAE;YACLrB,MAAM,GAAGsB,MAAM,CAACC,YAAY,CAAC,GAAG,CAACJ,UAAU,CAAC,CAAC,CAAC,GAAIE,GAAG,GAAG,EAAG,CAAC,GAAGrB,MAAM;YACrEqB,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,GAAG,EAAE,CAAC;UAC5B;UACA,OAAOrB,MAAM;QACf,CAAC;QAED,MAAM0B,WAAW,GAAGX,QAAQ,CAACF,QAAQ,CAAC;QACtC,MAAMc,SAAS,GAAGZ,QAAQ,CAACD,MAAM,CAAC;;QAElC;QACA,KAAK,IAAIc,GAAG,GAAGjB,QAAQ,EAAEiB,GAAG,IAAIhB,MAAM,EAAEgB,GAAG,EAAE,EAAE;UAC7C,KAAK,IAAIC,MAAM,GAAGH,WAAW,EAAEG,MAAM,IAAIF,SAAS,EAAEE,MAAM,EAAE,EAAE;YAC5D,MAAMb,GAAG,GAAGI,QAAQ,CAACS,MAAM,CAAC;YAC5B,MAAMC,WAAW,GAAG,GAAGd,GAAG,GAAGY,GAAG,EAAE;YAClC,MAAMG,IAAI,GAAGxB,SAAS,CAACuB,WAAW,CAAC;YAEnC,IAAIC,IAAI,IAAIA,IAAI,CAACC,CAAC,KAAKC,SAAS,IAAIF,IAAI,CAACC,CAAC,KAAK,IAAI,IAAID,IAAI,CAACC,CAAC,KAAK,EAAE,EAAE;cACpE,MAAME,KAAK,GAAG,OAAOH,IAAI,CAACC,CAAC,KAAK,QAAQ,GAAGD,IAAI,CAACC,CAAC,GAAGG,UAAU,CAACJ,IAAI,CAACC,CAAC,CAACI,QAAQ,CAAC,CAAC,CAAC;cACjF,IAAI,CAACC,KAAK,CAACH,KAAK,CAAC,EAAE;gBACjBzB,MAAM,CAAC6B,IAAI,CAACJ,KAAK,CAAC;gBAClBxB,SAAS,CAAC4B,IAAI,CAACR,WAAW,CAAC;cAC7B;YACF;UACF;QACF;QAEA,IAAIrB,MAAM,CAACS,MAAM,KAAK,CAAC,EAAE;UACvB,MAAM,IAAIZ,KAAK,CAAC,mBAAmB,CAAC;QACtC;QAEA5B,aAAa,CAAC;UAAE+B,MAAM;UAAEC;QAAU,CAAC,CAAC;MACtC,CAAC,CAAC,OAAOzB,KAAK,EAAE;QACdC,QAAQ,CAACD,KAAK,YAAYqB,KAAK,GAAGrB,KAAK,CAACsD,OAAO,GAAG,QAAQ,CAAC;MAC7D,CAAC,SAAS;QACRvD,YAAY,CAAC,KAAK,CAAC;MACrB;IACF,CAAC;IAEDS,MAAM,CAAC+C,OAAO,GAAG,MAAM;MACrBtD,QAAQ,CAAC,QAAQ,CAAC;MAClBF,YAAY,CAAC,KAAK,CAAC;IACrB,CAAC;IAEDS,MAAM,CAACgD,iBAAiB,CAACnD,IAAI,CAAC;EAChC,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMoD,oBAAoB,GAAG1E,WAAW,CAAC,MAA4B;IACnE,IAAI,CAACM,aAAa,CAACmC,MAAM,CAACS,MAAM,IAAI,CAAC3C,gBAAgB,CAAC2C,MAAM,EAAE;MAC5D,OAAO,IAAI;IACb;;IAEA;IACA,MAAMyB,iBAAiB,GAAGpE,gBAAgB,CAACqE,GAAG,CAACC,KAAK,IAAIA,KAAK,CAACC,gBAAgB,CAAC;IAC/E,MAAMC,eAAe,GAAGzE,aAAa,CAACmC,MAAM;IAE5C,IAAIkC,iBAAiB,CAACzB,MAAM,KAAK6B,eAAe,CAAC7B,MAAM,EAAE;MACvD,OAAO,IAAI;IACb;;IAEA;IACA,MAAM8B,cAAc,GAAG9E,kBAAkB,CAAC;MACxC+E,CAAC,EAAEN,iBAAiB;MACpBO,CAAC,EAAEH;IACL,CAAC,CAAC;;IAEF;IACA,MAAMI,UAAU,GAAGH,cAAc,CAACI,MAAM,CAAC,CAACC,IAAI,EAAEC,OAAO,KAAK;MAC1D,IAAIjB,KAAK,CAACiB,OAAO,CAACC,QAAQ,CAAC,IAAID,OAAO,CAACC,QAAQ,GAAG,CAAC,EAAE,OAAOF,IAAI;MAChE,IAAI,CAACA,IAAI,IAAIC,OAAO,CAACC,QAAQ,GAAGF,IAAI,CAACE,QAAQ,EAAE,OAAOD,OAAO;MAC7D,OAAOD,IAAI;IACb,CAAC,EAAE,IAA4B,CAAC;IAEhC,OAAOF,UAAU;EACnB,CAAC,EAAE,CAAC7E,aAAa,EAAEC,gBAAgB,CAAC,CAAC;;EAErC;EACA,MAAMiF,mBAAmB,GAAGxF,WAAW,CAAC,MAAM;IAC5C,IAAI,CAACS,UAAU,EAAE;MACfS,QAAQ,CAAC,UAAU,CAAC;MACpB;IACF;IAEA,MAAMuE,WAAW,GAAGf,oBAAoB,CAAC,CAAC;IAC1C,IAAI,CAACe,WAAW,EAAE;MAChBvE,QAAQ,CAAC,aAAa,CAAC;MACvB;IACF;IAEAJ,oBAAoB,CAAC2E,WAAW,CAAC;IAEjC,MAAMC,WAA+B,GAAGjF,UAAU,CAACgC,MAAM,CAACmC,GAAG,CAAC,CAACe,WAAW,EAAEC,KAAK,KAAK;MACpF,IAAIC,kBAAkB,GAAG,CAAC;;MAE1B;MACA,QAAQJ,WAAW,CAACtD,IAAI;QACtB,KAAK,aAAa;UAChB,IAAIwD,WAAW,GAAG,CAAC,EAAE;YACnB,MAAM,CAACG,CAAC,EAAEC,CAAC,CAAC,GAAGN,WAAW,CAACO,YAAY;YACvCH,kBAAkB,GAAGC,CAAC,GAAGtC,IAAI,CAACyC,GAAG,CAACN,WAAW,CAAC,GAAGI,CAAC;UACpD;UACA;QACF,KAAK,aAAa;UAChB,MAAM,CAACG,KAAK,EAAEC,KAAK,CAAC,GAAGV,WAAW,CAACO,YAAY;UAC/CH,kBAAkB,GAAGK,KAAK,GAAG1C,IAAI,CAAC4C,GAAG,CAACD,KAAK,GAAGR,WAAW,CAAC;UAC1D;QACF,KAAK,YAAY;UACf,MAAM,CAACU,MAAM,EAAEC,MAAM,EAAEC,MAAM,EAAEC,MAAM,CAAC,GAAGf,WAAW,CAACO,YAAY;UACjEH,kBAAkB,GAAGQ,MAAM,GAAG7C,IAAI,CAACiD,GAAG,CAACd,WAAW,EAAE,CAAC,CAAC,GAClCW,MAAM,GAAG9C,IAAI,CAACiD,GAAG,CAACd,WAAW,EAAE,CAAC,CAAC,GACjCY,MAAM,GAAGZ,WAAW,GAAGa,MAAM;UACjD;QACF,KAAK,OAAO;UACV,IAAIb,WAAW,GAAG,CAAC,EAAE;YACnB,MAAM,CAACe,KAAK,EAAEC,KAAK,CAAC,GAAGlB,WAAW,CAACO,YAAY;YAC/CH,kBAAkB,GAAGa,KAAK,GAAGlD,IAAI,CAACiD,GAAG,CAACd,WAAW,EAAEgB,KAAK,CAAC;UAC3D;UACA;QACF,KAAK,WAAW;UACd,MAAM,CAACC,KAAK,EAAEC,KAAK,EAAEC,KAAK,CAAC,GAAGrB,WAAW,CAACO,YAAY;UACtDH,kBAAkB,GAAGe,KAAK,GAAGpD,IAAI,CAACiD,GAAG,CAACd,WAAW,EAAE,CAAC,CAAC,GACjCkB,KAAK,GAAGlB,WAAW,GAAGmB,KAAK;UAC/C;MACJ;;MAEA;MACA,IAAIC,eAAe,GAAG,CAAC;MACvB,IAAInB,KAAK,GAAGrF,gBAAgB,CAAC2C,MAAM,EAAE;QACnC6D,eAAe,GAAGxG,gBAAgB,CAACqF,KAAK,CAAC,CAACd,gBAAgB;MAC5D;;MAEA;MACA,MAAM7D,KAAK,GAAGuC,IAAI,CAACwD,GAAG,CAACnB,kBAAkB,GAAGF,WAAW,CAAC;MAExD,OAAO;QACLA,WAAW;QACXsB,QAAQ,EAAExG,UAAU,CAACiC,SAAS,CAACkD,KAAK,CAAC;QACrCC,kBAAkB;QAClBkB,eAAe;QACfG,eAAe,EAAEzB,WAAW,CAACtD,IAAI;QACjCgF,UAAU,EAAE1B,WAAW,CAACF,QAAQ;QAChC6B,OAAO,EAAE3B,WAAW,CAAC2B,OAAO;QAC5BnG;MACF,CAAC;IACH,CAAC,CAAC;IAEFL,oBAAoB,CAAC8E,WAAW,CAAC;IACjCxE,QAAQ,CAAC,IAAI,CAAC;EAChB,CAAC,EAAE,CAACT,UAAU,EAAEiE,oBAAoB,CAAC,CAAC;;EAEtC;EACA,MAAM2C,aAAa,GAAGrH,WAAW,CAAC,MAAM;IACtC,IAAIW,iBAAiB,CAACuC,MAAM,KAAK,CAAC,IAAI,CAACzC,UAAU,EAAE;MACjDS,QAAQ,CAAC,WAAW,CAAC;MACrB;IACF;IAEA,MAAMe,QAAQ,GAAGhC,IAAI,CAACqH,KAAK,CAACC,QAAQ,CAAC,CAAC;;IAEtC;IACA,MAAMC,IAAI,GAAG,EAAE,CAAC,CAAC;IACjB,MAAMC,IAAI,GAAG,EAAE,CAAC,CAAC;;IAEjB;IACA,MAAMC,UAAU,GAAG,EAAE;IACrB,KAAK,IAAIzE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGwE,IAAI,EAAExE,CAAC,EAAE,EAAE;MAC7ByE,UAAU,CAACpD,IAAI,CAAClB,QAAQ,CAACH,CAAC,GAAG,CAAC,CAAC,CAAC;IAClC;;IAEA;IACA,MAAM0E,UAAU,GAAG,EAAE;;IAErB;IACAA,UAAU,CAACrD,IAAI,CAAC,CAAC,EAAE,EAAE,GAAGoD,UAAU,CAAC,CAAC;;IAEpC;IACA,KAAK,IAAI9D,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAG4D,IAAI,EAAE5D,GAAG,EAAE,EAAE;MACnC,MAAMgE,OAAO,GAAG,CAAChE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;MAC3B,KAAK,IAAIZ,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAGyE,IAAI,EAAEzE,GAAG,EAAE,EAAE;QACnC,MAAM6E,SAAS,GAAGjE,GAAG,GAAG6D,IAAI,GAAGzE,GAAG;QAClC,IAAI6E,SAAS,GAAGpH,UAAU,CAACgC,MAAM,CAACS,MAAM,EAAE;UACxC0E,OAAO,CAACtD,IAAI,CAAC7D,UAAU,CAACgC,MAAM,CAACoF,SAAS,CAAC,CAAC;QAC5C,CAAC,MAAM;UACLD,OAAO,CAACtD,IAAI,CAAC,EAAE,CAAC;QAClB;MACF;MACAqD,UAAU,CAACrD,IAAI,CAACsD,OAAO,CAAC;IAC1B;;IAEA;IACAD,UAAU,CAACrD,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;IACrBqD,UAAU,CAACrD,IAAI,CAAC,CAAC,QAAQ,CAAC,CAAC;IAC3BqD,UAAU,CAACrD,IAAI,CAAC,CAAC,EAAE,EAAE,GAAGoD,UAAU,CAAC,CAAC;;IAEpC;IACA,KAAK,IAAI9D,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAG4D,IAAI,EAAE5D,GAAG,EAAE,EAAE;MACnC,MAAMgE,OAAO,GAAG,CAAChE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;MAC3B,KAAK,IAAIZ,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAGyE,IAAI,EAAEzE,GAAG,EAAE,EAAE;QACnC,MAAM6E,SAAS,GAAGjE,GAAG,GAAG6D,IAAI,GAAGzE,GAAG;QAClC,IAAI6E,SAAS,GAAGlH,iBAAiB,CAACuC,MAAM,EAAE;UACxC0E,OAAO,CAACtD,IAAI,CAAC3D,iBAAiB,CAACkH,SAAS,CAAC,CAAChC,kBAAkB,CAACiC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC1E,CAAC,MAAM;UACLF,OAAO,CAACtD,IAAI,CAAC,EAAE,CAAC;QAClB;MACF;MACAqD,UAAU,CAACrD,IAAI,CAACsD,OAAO,CAAC;IAC1B;;IAEA;IACAD,UAAU,CAACrD,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;IACrBqD,UAAU,CAACrD,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC;IACzBqD,UAAU,CAACrD,IAAI,CAAC,CAAC,EAAE,EAAE,GAAGoD,UAAU,CAAC,CAAC;;IAEpC;IACA,KAAK,IAAI9D,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAG4D,IAAI,EAAE5D,GAAG,EAAE,EAAE;MACnC,MAAMgE,OAAO,GAAG,CAAChE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;MAC3B,KAAK,IAAIZ,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAGyE,IAAI,EAAEzE,GAAG,EAAE,EAAE;QACnC,MAAM6E,SAAS,GAAGjE,GAAG,GAAG6D,IAAI,GAAGzE,GAAG;QAClC,IAAI6E,SAAS,GAAGlH,iBAAiB,CAACuC,MAAM,EAAE;UACxC0E,OAAO,CAACtD,IAAI,CAAC3D,iBAAiB,CAACkH,SAAS,CAAC,CAAC5G,KAAK,CAAC6G,OAAO,CAAC,CAAC,CAAC,CAAC;QAC7D,CAAC,MAAM;UACLF,OAAO,CAACtD,IAAI,CAAC,EAAE,CAAC;QAClB;MACF;MACAqD,UAAU,CAACrD,IAAI,CAACsD,OAAO,CAAC;IAC1B;IAEA,MAAMrF,SAAS,GAAGtC,IAAI,CAACqH,KAAK,CAACS,YAAY,CAACJ,UAAU,CAAC;IACrD1H,IAAI,CAACqH,KAAK,CAACU,iBAAiB,CAAC/F,QAAQ,EAAEM,SAAS,EAAE,MAAM,CAAC;;IAEzD;IACA,MAAM0F,UAAU,GAAG,CACjB,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,SAAS,EAAE,MAAM,CAAC,EAChE,GAAGtH,iBAAiB,CAACiE,GAAG,CAAC5C,MAAM,IAAI,CACjCA,MAAM,CAACiF,QAAQ,EACfjF,MAAM,CAAC2D,WAAW,EAClB3D,MAAM,CAAC6D,kBAAkB,CAACiC,OAAO,CAAC,CAAC,CAAC,EACpC9F,MAAM,CAAC+E,eAAe,CAACe,OAAO,CAAC,CAAC,CAAC,EACjC9F,MAAM,CAACf,KAAK,CAAC6G,OAAO,CAAC,CAAC,CAAC,EACvBI,YAAY,CAAClG,MAAM,CAACkF,eAAe,CAAC,EACpClF,MAAM,CAACmF,UAAU,CAACW,OAAO,CAAC,CAAC,CAAC,EAC5B9F,MAAM,CAACoF,OAAO,CACf,CAAC,CACH;IAED,MAAMe,eAAe,GAAGlI,IAAI,CAACqH,KAAK,CAACS,YAAY,CAACE,UAAU,CAAC;IAC3DhI,IAAI,CAACqH,KAAK,CAACU,iBAAiB,CAAC/F,QAAQ,EAAEkG,eAAe,EAAE,MAAM,CAAC;;IAE/D;IACA,IAAItH,iBAAiB,EAAE;MACrB,MAAMuH,WAAW,GAAG,CAClB,CAAC,MAAM,EAAE,EAAE,CAAC,EACZ,CAAC,MAAM,EAAEF,YAAY,CAACrH,iBAAiB,CAACsB,IAAI,CAAC,CAAC,EAC9C,CAAC,MAAM,EAAEtB,iBAAiB,CAACuG,OAAO,CAAC,EACnC,CAAC,KAAK,EAAEvG,iBAAiB,CAAC0E,QAAQ,CAACuC,OAAO,CAAC,CAAC,CAAC,CAAC,EAC9C,CAAC,MAAM,EAAEjH,iBAAiB,CAACwH,IAAI,CAACP,OAAO,CAAC,CAAC,CAAC,CAAC,EAC3C,CAAC,KAAK,EAAEjH,iBAAiB,CAACyH,GAAG,CAACR,OAAO,CAAC,CAAC,CAAC,CAAC,EACzC,CAAC,MAAM,EAAEjH,iBAAiB,CAAC0H,QAAQ,CAACT,OAAO,CAAC,CAAC,CAAC,CAAC,CAChD;MAED,MAAMU,SAAS,GAAGvI,IAAI,CAACqH,KAAK,CAACS,YAAY,CAACK,WAAW,CAAC;MACtDnI,IAAI,CAACqH,KAAK,CAACU,iBAAiB,CAAC/F,QAAQ,EAAEuG,SAAS,EAAE,MAAM,CAAC;IAC3D;;IAEA;IACA,MAAMC,QAAQ,GAAG,YAAY,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO;IACzE3I,IAAI,CAAC4I,SAAS,CAAC5G,QAAQ,EAAEwG,QAAQ,CAAC;EACpC,CAAC,EAAE,CAAC9H,iBAAiB,EAAEE,iBAAiB,EAAEJ,UAAU,CAAC,CAAC;;EAEtD;EACA,MAAMyH,YAAY,GAAI/F,IAAY,IAAK;IACrC,MAAM2G,MAAiC,GAAG;MACxC,aAAa,EAAE,MAAM;MACrB,aAAa,EAAE,MAAM;MACrB,YAAY,EAAE,SAAS;MACvB,OAAO,EAAE,OAAO;MAChB,WAAW,EAAE;IACf,CAAC;IACD,OAAOA,MAAM,CAAC3G,IAAI,CAAC,IAAIA,IAAI;EAC7B,CAAC;EAED,oBACE/B,OAAA;IAAK2I,SAAS,EAAC,mCAAmC;IAAAC,QAAA,gBAChD5I,OAAA;MAAI2I,SAAS,EAAC,4BAA4B;MAAAC,QAAA,EAAC;IAAM;MAAAP,QAAA,EAAAQ,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAGtD/I,OAAA;MAAK2I,SAAS,EAAC,MAAM;MAAAC,QAAA,gBACnB5I,OAAA;QAAI2I,SAAS,EAAC,kBAAkB;QAAAC,QAAA,EAAC;MAAiB;QAAAP,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACvD/I,OAAA;QAAK2I,SAAS,EAAC,mEAAmE;QAAAC,QAAA,gBAChF5I,OAAA;UACE+B,IAAI,EAAC,MAAM;UACXiH,MAAM,EAAC,YAAY;UACnBC,QAAQ,EAAElI,gBAAiB;UAC3B4H,SAAS,EAAC,QAAQ;UAClBO,EAAE,EAAC;QAAoB;UAAAb,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxB,CAAC,eACF/I,OAAA;UACEmJ,OAAO,EAAC,oBAAoB;UAC5BR,SAAS,EAAC,yHAAyH;UAAAC,QAAA,EACpI;QAED;UAAAP,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACR/I,OAAA;UAAG2I,SAAS,EAAC,4BAA4B;UAAAC,QAAA,EAAC;QAE1C;UAAAP,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAV,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC;IAAA;MAAAV,QAAA,EAAAQ,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,EAGLpI,SAAS,iBACRX,OAAA;MAAK2I,SAAS,EAAC,uDAAuD;MAAAC,QAAA,eACpE5I,OAAA;QAAG2I,SAAS,EAAC,eAAe;QAAAC,QAAA,EAAC;MAAS;QAAAP,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG;IAAC;MAAAV,QAAA,EAAAQ,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACvC,CACN,EAGAlI,KAAK,iBACJb,OAAA;MAAK2I,SAAS,EAAC,qDAAqD;MAAAC,QAAA,eAClE5I,OAAA;QAAG2I,SAAS,EAAC,cAAc;QAAAC,QAAA,EAAE/H;MAAK;QAAAwH,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI;IAAC;MAAAV,QAAA,EAAAQ,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACpC,CACN,EAGA1I,UAAU,iBACTL,OAAA;MAAK2I,SAAS,EAAC,gCAAgC;MAAAC,QAAA,gBAC7C5I,OAAA;QAAI2I,SAAS,EAAC,kBAAkB;QAAAC,QAAA,EAAC;MAAM;QAAAP,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC5C/I,OAAA;QAAK2I,SAAS,EAAC,gCAAgC;QAAAC,QAAA,gBAC7C5I,OAAA;UAAA4I,QAAA,gBACE5I,OAAA;YAAM2I,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAM;YAAAP,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC7C/I,OAAA;YAAM2I,SAAS,EAAC,aAAa;YAAAC,QAAA,EAAEvI,UAAU,CAACgC,MAAM,CAACS;UAAM;YAAAuF,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAV,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5D,CAAC,eACN/I,OAAA;UAAA4I,QAAA,gBACE5I,OAAA;YAAM2I,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAK;YAAAP,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC5C/I,OAAA;YAAM2I,SAAS,EAAC,aAAa;YAAAC,QAAA,GAC1BxF,IAAI,CAACgG,GAAG,CAAC,GAAG/I,UAAU,CAACgC,MAAM,CAAC,CAACqF,OAAO,CAAC,CAAC,CAAC,EAAC,KAAG,EAACtE,IAAI,CAACiG,GAAG,CAAC,GAAGhJ,UAAU,CAACgC,MAAM,CAAC,CAACqF,OAAO,CAAC,CAAC,CAAC;UAAA;YAAAW,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACpF,CAAC;QAAA;UAAAV,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACJ,CAAC;MAAA;QAAAV,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAV,QAAA,EAAAQ,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,EAGA1I,UAAU,IAAIH,aAAa,CAACmC,MAAM,CAACS,MAAM,GAAG,CAAC,IAAI3C,gBAAgB,CAAC2C,MAAM,GAAG,CAAC,iBAC3E9C,OAAA;MAAK2I,SAAS,EAAC,MAAM;MAAAC,QAAA,eACnB5I,OAAA;QACEsJ,OAAO,EAAElE,mBAAoB;QAC7BuD,SAAS,EAAC,mFAAmF;QAAAC,QAAA,EAC9F;MAED;QAAAP,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ;IAAC;MAAAV,QAAA,EAAAQ,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CACN,EAGAtI,iBAAiB,iBAChBT,OAAA;MAAK2I,SAAS,EAAC,gCAAgC;MAAAC,QAAA,gBAC7C5I,OAAA;QAAI2I,SAAS,EAAC,kBAAkB;QAAAC,QAAA,EAAC;MAAS;QAAAP,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC/C/I,OAAA;QAAK2I,SAAS,EAAC,gCAAgC;QAAAC,QAAA,gBAC7C5I,OAAA;UAAA4I,QAAA,gBACE5I,OAAA;YAAM2I,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAK;YAAAP,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC5C/I,OAAA;YAAM2I,SAAS,EAAC,aAAa;YAAAC,QAAA,EAAEd,YAAY,CAACrH,iBAAiB,CAACsB,IAAI;UAAC;YAAAsG,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAV,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxE,CAAC,eACN/I,OAAA;UAAA4I,QAAA,gBACE5I,OAAA;YAAM2I,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAI;YAAAP,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC3C/I,OAAA;YAAM2I,SAAS,EAAC,aAAa;YAAAC,QAAA,EAAEnI,iBAAiB,CAAC0E,QAAQ,CAACuC,OAAO,CAAC,CAAC;UAAC;YAAAW,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAV,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzE,CAAC,eACN/I,OAAA;UAAK2I,SAAS,EAAC,YAAY;UAAAC,QAAA,gBACzB5I,OAAA;YAAM2I,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAK;YAAAP,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC5C/I,OAAA;YAAM2I,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAEnI,iBAAiB,CAACuG;UAAO;YAAAqB,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAV,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvE,CAAC;MAAA;QAAAV,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAV,QAAA,EAAAQ,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,EAGAxI,iBAAiB,CAACuC,MAAM,GAAG,CAAC,iBAC3B9C,OAAA;MAAK2I,SAAS,EAAC,MAAM;MAAAC,QAAA,gBACnB5I,OAAA;QAAK2I,SAAS,EAAC,wCAAwC;QAAAC,QAAA,gBACrD5I,OAAA;UAAI2I,SAAS,EAAC,aAAa;UAAAC,QAAA,EAAC;QAAI;UAAAP,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACrC/I,OAAA;UACEsJ,OAAO,EAAErC,aAAc;UACvB0B,SAAS,EAAC,yFAAyF;UAAAC,QAAA,EACpG;QAED;UAAAP,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAV,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eAEN/I,OAAA;QAAK2I,SAAS,EAAC,qEAAqE;QAAAC,QAAA,EACjFrI,iBAAiB,CAACiE,GAAG,CAAC,CAAC5C,MAAM,EAAE4D,KAAK,kBACnCxF,OAAA;UAAiB2I,SAAS,EAAC,sHAAsH;UAAAC,QAAA,gBAC/I5I,OAAA;YAAK2I,SAAS,EAAC,wCAAwC;YAAAC,QAAA,gBACrD5I,OAAA;cAAM2I,SAAS,EAAC,mCAAmC;cAAAC,QAAA,GAAC,gBAAI,EAAChH,MAAM,CAACiF,QAAQ;YAAA;cAAAwB,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAChF/I,OAAA;cAAM2I,SAAS,EAAC,qDAAqD;cAAAC,QAAA,EAAEd,YAAY,CAAClG,MAAM,CAACkF,eAAe;YAAC;cAAAuB,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAV,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAChH,CAAC,eAEN/I,OAAA;YAAK2I,SAAS,EAAC,WAAW;YAAAC,QAAA,gBACxB5I,OAAA;cAAK2I,SAAS,EAAC,sBAAsB;cAAAC,QAAA,gBACnC5I,OAAA;gBAAM2I,SAAS,EAAC,uBAAuB;gBAAAC,QAAA,EAAC;cAAI;gBAAAP,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACnD/I,OAAA;gBAAM2I,SAAS,EAAC,qBAAqB;gBAAAC,QAAA,EAAEhH,MAAM,CAAC+E,eAAe,CAACe,OAAO,CAAC,CAAC;cAAC;gBAAAW,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC;YAAA;cAAAV,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC7E,CAAC,eAEN/I,OAAA;cAAK2I,SAAS,EAAC,sBAAsB;cAAAC,QAAA,gBACnC5I,OAAA;gBAAM2I,SAAS,EAAC,uBAAuB;gBAAAC,QAAA,EAAC;cAAI;gBAAAP,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACnD/I,OAAA;gBAAM2I,SAAS,EAAC,qBAAqB;gBAAAC,QAAA,EAAEhH,MAAM,CAAC2D,WAAW,CAACmC,OAAO,CAAC,CAAC;cAAC;gBAAAW,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC;YAAA;cAAAV,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACzE,CAAC,eAEN/I,OAAA;cAAK2I,SAAS,EAAC,sBAAsB;cAAAC,QAAA,gBACnC5I,OAAA;gBAAM2I,SAAS,EAAC,uBAAuB;gBAAAC,QAAA,EAAC;cAAI;gBAAAP,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACnD/I,OAAA;gBAAM2I,SAAS,EAAC,mCAAmC;gBAAAC,QAAA,EAAEhH,MAAM,CAAC6D,kBAAkB,CAACiC,OAAO,CAAC,CAAC;cAAC;gBAAAW,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC;YAAA;cAAAV,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC9F,CAAC,eAEN/I,OAAA;cAAK2I,SAAS,EAAC,sBAAsB;cAAAC,QAAA,gBACnC5I,OAAA;gBAAM2I,SAAS,EAAC,uBAAuB;gBAAAC,QAAA,EAAC;cAAG;gBAAAP,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eAClD/I,OAAA;gBAAM2I,SAAS,EAAE,uBACf/G,MAAM,CAACf,KAAK,GAAG,GAAG,GAAG,gBAAgB,GACrCe,MAAM,CAACf,KAAK,GAAG,GAAG,GAAG,iBAAiB,GAAG,cAAc,EACtD;gBAAA+H,QAAA,EACAhH,MAAM,CAACf,KAAK,CAAC6G,OAAO,CAAC,CAAC;cAAC;gBAAAW,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACpB,CAAC;YAAA;cAAAV,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACJ,CAAC,eAEN/I,OAAA;cAAK2I,SAAS,EAAC,oCAAoC;cAAAC,QAAA,gBACjD5I,OAAA;gBAAK2I,SAAS,EAAC,4BAA4B;gBAAAC,QAAA,EAAC;cAAK;gBAAAP,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eACvD/I,OAAA;gBAAK2I,SAAS,EAAC,6DAA6D;gBAAAC,QAAA,EACzEhH,MAAM,CAACoF;cAAO;gBAAAqB,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACZ,CAAC;YAAA;cAAAV,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eAEN/I,OAAA;cAAK2I,SAAS,EAAC,2BAA2B;cAAAC,QAAA,gBACxC5I,OAAA;gBAAM2I,SAAS,EAAC,uBAAuB;gBAAAC,QAAA,EAAC;cAAI;gBAAAP,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACnD/I,OAAA;gBAAM2I,SAAS,EAAE,8CACf/G,MAAM,CAACmF,UAAU,GAAG,GAAG,GAAG,6BAA6B,GACvDnF,MAAM,CAACmF,UAAU,GAAG,GAAG,GAAG,+BAA+B,GACzD,yBAAyB,EACxB;gBAAA6B,QAAA,GACA,CAAChH,MAAM,CAACmF,UAAU,GAAG,GAAG,EAAEW,OAAO,CAAC,CAAC,CAAC,EAAC,GACxC;cAAA;gBAAAW,QAAA,EAAAQ,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAV,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACJ,CAAC;UAAA;YAAAV,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA,GAjDEvD,KAAK;UAAA6C,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAkDV,CACN;MAAC;QAAAV,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eAGN/I,OAAA;QAAK2I,SAAS,EAAC,gCAAgC;QAAAC,QAAA,gBAC7C5I,OAAA;UAAI2I,SAAS,EAAC,kBAAkB;UAAAC,QAAA,EAAC;QAAI;UAAAP,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC1C/I,OAAA;UAAK2I,SAAS,EAAC,gCAAgC;UAAAC,QAAA,gBAC7C5I,OAAA;YAAA4I,QAAA,gBACE5I,OAAA;cAAM2I,SAAS,EAAC,eAAe;cAAAC,QAAA,EAAC;YAAM;cAAAP,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC7C/I,OAAA;cAAM2I,SAAS,EAAC,aAAa;cAAAC,QAAA,EAAErI,iBAAiB,CAACuC;YAAM;cAAAuF,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAV,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5D,CAAC,eACN/I,OAAA;YAAA4I,QAAA,gBACE5I,OAAA;cAAM2I,SAAS,EAAC,eAAe;cAAAC,QAAA,EAAC;YAAM;cAAAP,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC7C/I,OAAA;cAAM2I,SAAS,EAAC,aAAa;cAAAC,QAAA,EAC1B,CAACrI,iBAAiB,CAACyE,MAAM,CAAC,CAACuE,GAAG,EAAEC,CAAC,KAAKD,GAAG,GAAGC,CAAC,CAAC/D,kBAAkB,EAAE,CAAC,CAAC,GAAGlF,iBAAiB,CAACuC,MAAM,EAAE4E,OAAO,CAAC,CAAC;YAAC;cAAAW,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACxG,CAAC;UAAA;YAAAV,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ,CAAC,eACN/I,OAAA;YAAA4I,QAAA,gBACE5I,OAAA;cAAM2I,SAAS,EAAC,eAAe;cAAAC,QAAA,EAAC;YAAK;cAAAP,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC5C/I,OAAA;cAAM2I,SAAS,EAAC,aAAa;cAAAC,QAAA,GAC1BxF,IAAI,CAACgG,GAAG,CAAC,GAAG7I,iBAAiB,CAACiE,GAAG,CAACgF,CAAC,IAAIA,CAAC,CAAC/D,kBAAkB,CAAC,CAAC,CAACiC,OAAO,CAAC,CAAC,CAAC,EAAC,IAC1E,EAACtE,IAAI,CAACiG,GAAG,CAAC,GAAG9I,iBAAiB,CAACiE,GAAG,CAACgF,CAAC,IAAIA,CAAC,CAAC/D,kBAAkB,CAAC,CAAC,CAACiC,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAW,QAAA,EAAAQ,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrE,CAAC;UAAA;YAAAV,QAAA,EAAAQ,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ,CAAC;QAAA;UAAAV,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAV,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAV,QAAA,EAAAQ,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,EAGA,CAAC1I,UAAU,iBACVL,OAAA;MAAK2I,SAAS,EAAC,2DAA2D;MAAAC,QAAA,gBACxE5I,OAAA;QAAI2I,SAAS,EAAC,kCAAkC;QAAAC,QAAA,EAAC;MAAI;QAAAP,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC1D/I,OAAA;QAAI2I,SAAS,EAAC,mCAAmC;QAAAC,QAAA,gBAC/C5I,OAAA;UAAA4I,QAAA,EAAI;QAAoB;UAAAP,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC7B/I,OAAA;UAAA4I,QAAA,EAAI;QAAkC;UAAAP,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC3C/I,OAAA;UAAA4I,QAAA,EAAI;QAAoB;UAAAP,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC7B/I,OAAA;UAAA4I,QAAA,EAAI;QAAqB;UAAAP,QAAA,EAAAQ,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC;MAAA;QAAAV,QAAA,EAAAQ,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5B,CAAC;IAAA;MAAAV,QAAA,EAAAQ,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CACN;EAAA;IAAAV,QAAA,EAAAQ,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAAC3I,EAAA,CAphBIH,oBAAyD;AAAAwJ,EAAA,GAAzDxJ,oBAAyD;AAshB/D,eAAeA,oBAAoB;AAAC,IAAAwJ,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}